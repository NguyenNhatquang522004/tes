"use strict";(globalThis.webpackChunkuip_urban_intelligence_platform_docs=globalThis.webpackChunkuip_urban_intelligence_platform_docs||[]).push([[1761],{8453:(n,e,r)=>{r.d(e,{R:()=>s,x:()=>o});var t=r(6540);const i={},a=t.createContext(i);function s(n){const e=t.useContext(a);return t.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:s(n.components),t.createElement(a.Provider,{value:e},n.children)}},9353:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>s,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"backend/routes/multi-agent-routes","title":"Multi-Agent Routes","description":"REST API endpoints for coordinated multi-agent interactions combining GraphInvestigator and TrafficMaestro for comprehensive incident analysis.","source":"@site/docs/backend/routes/multiAgent.md","sourceDirName":"backend/routes","slug":"/backend/routes/multi-agent-routes","permalink":"/tes/vi/docs/backend/routes/multi-agent-routes","draft":false,"unlisted":false,"editUrl":"https://github.com/NguyenNhatquang522004/UIP-Urban_Intelligence_Platform/tree/main/apps/traffic-web-app/frontend/docs/docs/backend/routes/multiAgent.md","tags":[],"version":"current","sidebarPosition":12,"frontMatter":{"id":"multi-agent-routes","title":"Multi-Agent Routes","sidebar_label":"Multi-Agent","sidebar_position":12,"description":"REST API endpoints for coordinated multi-agent interactions combining GraphInvestigator and TrafficMaestro for comprehensive incident analysis.","keywords":["multi-agent","coordination","graph-investigator","traffic-maestro","ai"]}}');var i=r(4848),a=r(8453);const s={id:"multi-agent-routes",title:"Multi-Agent Routes",sidebar_label:"Multi-Agent",sidebar_position:12,description:"REST API endpoints for coordinated multi-agent interactions combining GraphInvestigator and TrafficMaestro for comprehensive incident analysis.",keywords:["multi-agent","coordination","graph-investigator","traffic-maestro","ai"]},o="Multi-Agent Routes",c={},d=[{value:"Base Path",id:"base-path",level:2},{value:"Endpoints Summary",id:"endpoints-summary",level:2},{value:"GraphInvestigator Endpoints",id:"graphinvestigator-endpoints",level:2},{value:"POST /api/multi-agent/graph-investigator/investigate",id:"post-apimulti-agentgraph-investigatorinvestigate",level:3},{value:"TrafficMaestro Endpoints",id:"trafficmaestro-endpoints",level:2},{value:"POST /api/multi-agent/traffic-maestro/predict",id:"post-apimulti-agenttraffic-maestropredict",level:3},{value:"Combined Analysis Endpoints",id:"combined-analysis-endpoints",level:2},{value:"POST /api/multi-agent/full-analysis",id:"post-apimulti-agentfull-analysis",level:3},{value:"POST /api/multi-agent/coordinated",id:"post-apimulti-agentcoordinated",level:3},{value:"Agent Coordination Architecture",id:"agent-coordination-architecture",level:2},{value:"Agent Singleton Management",id:"agent-singleton-management",level:2},{value:"Error Handling",id:"error-handling",level:2},{value:"Rate Limiting",id:"rate-limiting",level:2},{value:"Related Documentation",id:"related-documentation",level:2},{value:"References",id:"references",level:2}];function l(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.header,{children:(0,i.jsx)(e.h1,{id:"multi-agent-routes",children:"Multi-Agent Routes"})}),"\n",(0,i.jsxs)(e.p,{children:["REST API endpoints for ",(0,i.jsx)(e.strong,{children:"coordinated multi-agent interactions"})," combining GraphInvestigator and TrafficMaestro for comprehensive incident analysis and predictive orchestration."]}),"\n",(0,i.jsx)(e.h2,{id:"base-path",children:"Base Path"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"/api/multi-agent\n"})}),"\n",(0,i.jsx)(e.h2,{id:"endpoints-summary",children:"Endpoints Summary"}),"\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"Method"}),(0,i.jsx)(e.th,{children:"Endpoint"}),(0,i.jsx)(e.th,{children:"Description"}),(0,i.jsx)(e.th,{children:"Agents"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"POST"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"/graph-investigator/investigate"})}),(0,i.jsx)(e.td,{children:"Multimodal incident analysis"}),(0,i.jsx)(e.td,{children:"GraphInvestigator"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"POST"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"/traffic-maestro/predict"})}),(0,i.jsx)(e.td,{children:"Event-based congestion prediction"}),(0,i.jsx)(e.td,{children:"TrafficMaestro"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"POST"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"/full-analysis"})}),(0,i.jsx)(e.td,{children:"Combined investigation + prediction"}),(0,i.jsx)(e.td,{children:"Both"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"POST"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"/coordinated"})}),(0,i.jsx)(e.td,{children:"Synchronized agent responses"}),(0,i.jsx)(e.td,{children:"Both"})]})]})]}),"\n",(0,i.jsx)(e.h2,{id:"graphinvestigator-endpoints",children:"GraphInvestigator Endpoints"}),"\n",(0,i.jsx)(e.h3,{id:"post-apimulti-agentgraph-investigatorinvestigate",children:"POST /api/multi-agent/graph-investigator/investigate"}),"\n",(0,i.jsx)(e.p,{children:"Investigate an incident using multimodal analysis: internal context (Stellio + Neo4j), visual analysis (Gemini Vision), and external intelligence (Tavily Search)."}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"Request Body:"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-json",children:'{\r\n  "accidentId": "urn:ngsi-ld:RoadAccident:001"\r\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"Response:"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-json",children:'{\r\n  "success": true,\r\n  "data": {\r\n    "investigation": {\r\n      "accidentId": "urn:ngsi-ld:RoadAccident:001",\r\n      "severity": "high",\r\n      "timestamp": "2025-01-15T10:30:00.000Z"\r\n    },\r\n    "internalContext": {\r\n      "stellioData": {\r\n        "type": "collision",\r\n        "location": { "lat": 10.77, "lon": 106.70 },\r\n        "casualties": 2\r\n      },\r\n      "neo4jRelationships": [\r\n        {\r\n          "type": "NEAR_TO",\r\n          "entity": "Camera:nearby-001",\r\n          "distance": 150\r\n        }\r\n      ]\r\n    },\r\n    "visualAnalysis": {\r\n      "detected": ["vehicle_damage", "emergency_response", "road_blockage"],\r\n      "confidence": 0.92,\r\n      "description": "Multi-vehicle collision with emergency services on scene"\r\n    },\r\n    "externalIntelligence": {\r\n      "newsArticles": [\r\n        {\r\n          "title": "Major accident on Nguyen Hue Boulevard",\r\n          "source": "VnExpress",\r\n          "summary": "Traffic severely affected..."\r\n        }\r\n      ],\r\n      "socialMedia": {\r\n        "mentions": 45,\r\n        "sentiment": "concerned"\r\n      }\r\n    },\r\n    "recommendation": {\r\n      "priority": "critical",\r\n      "actions": [\r\n        "Dispatch additional emergency units",\r\n        "Activate traffic diversion",\r\n        "Alert public via message boards"\r\n      ],\r\n      "estimatedClearTime": "2 hours"\r\n    }\r\n  }\r\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"Example:"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:'curl -X POST http://localhost:5000/api/multi-agent/graph-investigator/investigate \\\r\n  -H "Content-Type: application/json" \\\r\n  -d \'{"accidentId": "urn:ngsi-ld:RoadAccident:001"}\'\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"trafficmaestro-endpoints",children:"TrafficMaestro Endpoints"}),"\n",(0,i.jsx)(e.h3,{id:"post-apimulti-agenttraffic-maestropredict",children:"POST /api/multi-agent/traffic-maestro/predict"}),"\n",(0,i.jsx)(e.p,{children:"Predict traffic impact from upcoming events using external event APIs (Ticketmaster, Google Calendar)."}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"Request Body:"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-json",children:'{\r\n  "eventQuery": "concerts near Ho Chi Minh City",\r\n  "location": {\r\n    "lat": 10.7731,\r\n    "lng": 106.7030\r\n  },\r\n  "timeRange": {\r\n    "start": "2025-01-15T00:00:00.000Z",\r\n    "end": "2025-01-16T00:00:00.000Z"\r\n  }\r\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"Response:"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-json",children:'{\r\n  "success": true,\r\n  "data": {\r\n    "events": [\r\n      {\r\n        "id": "event-001",\r\n        "name": "K-Pop Concert",\r\n        "venue": "Phu Tho Stadium",\r\n        "startTime": "2025-01-15T19:00:00.000Z",\r\n        "expectedAttendance": 25000\r\n      }\r\n    ],\r\n    "predictions": [\r\n      {\r\n        "roadSegment": "urn:ngsi-ld:RoadSegment:phu-tho",\r\n        "timeSlot": "17:00-19:00",\r\n        "predictedCongestion": "severe",\r\n        "confidence": 0.87,\r\n        "speedReduction": 65,\r\n        "alternativeRoutes": [\r\n          "Via Ly Thuong Kiet",\r\n          "Via 3/2 Boulevard"\r\n        ]\r\n      }\r\n    ],\r\n    "recommendations": [\r\n      {\r\n        "type": "pre-event",\r\n        "time": "16:00",\r\n        "action": "Activate traffic officers at key intersections"\r\n      },\r\n      {\r\n        "type": "during-event",\r\n        "time": "17:00-19:00",\r\n        "action": "Redirect traffic from stadium area"\r\n      },\r\n      {\r\n        "type": "post-event",\r\n        "time": "21:00-23:00",\r\n        "action": "Prepare for mass exodus, open additional lanes"\r\n      }\r\n    ]\r\n  }\r\n}\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"combined-analysis-endpoints",children:"Combined Analysis Endpoints"}),"\n",(0,i.jsx)(e.h3,{id:"post-apimulti-agentfull-analysis",children:"POST /api/multi-agent/full-analysis"}),"\n",(0,i.jsx)(e.p,{children:"Perform comprehensive analysis combining both agents for complete situational awareness."}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"Request Body:"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-json",children:'{\r\n  "accidentId": "urn:ngsi-ld:RoadAccident:001",\r\n  "includeEventImpact": true,\r\n  "location": {\r\n    "lat": 10.7731,\r\n    "lng": 106.7030\r\n  }\r\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"Response:"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-json",children:'{\r\n  "success": true,\r\n  "data": {\r\n    "investigation": {\r\n      // GraphInvestigator results\r\n    },\r\n    "prediction": {\r\n      // TrafficMaestro results\r\n    },\r\n    "correlation": {\r\n      "foundCorrelation": true,\r\n      "type": "event-accident",\r\n      "description": "Accident likely caused by increased traffic from nearby concert"\r\n    },\r\n    "combinedRecommendations": [\r\n      "Priority: Address accident immediately",\r\n      "Secondary: Prepare for event traffic surge",\r\n      "Alert event-goers of alternative routes"\r\n    ],\r\n    "overallSeverity": "critical",\r\n    "estimatedResolutionTime": "3 hours"\r\n  }\r\n}\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"post-apimulti-agentcoordinated",children:"POST /api/multi-agent/coordinated"}),"\n",(0,i.jsx)(e.p,{children:"Get synchronized responses from both agents with shared context."}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"Request Body:"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-json",children:'{\r\n  "query": "What caused the traffic jam on Nguyen Hue?",\r\n  "location": {\r\n    "lat": 10.7731,\r\n    "lng": 106.7030\r\n  },\r\n  "recentAccidents": ["urn:ngsi-ld:RoadAccident:001"],\r\n  "includeEventContext": true\r\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"Response:"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-json",children:'{\r\n  "success": true,\r\n  "data": {\r\n    "graphInvestigator": {\r\n      "analysis": "Accident at intersection caused initial blockage...",\r\n      "confidence": 0.89\r\n    },\r\n    "trafficMaestro": {\r\n      "analysis": "Event traffic from stadium compounded the situation...",\r\n      "confidence": 0.82\r\n    },\r\n    "synthesized": {\r\n      "summary": "The traffic jam was caused by a combination of...",\r\n      "rootCauses": [\r\n        "Vehicle collision at 10:15 AM",\r\n        "Concert traffic starting at 5:00 PM"\r\n      ],\r\n      "timeline": [\r\n        { "time": "10:15", "event": "Initial accident" },\r\n        { "time": "17:00", "event": "Event traffic surge" }\r\n      ]\r\n    }\r\n  }\r\n}\n'})}),"\n",(0,i.jsx)(e.h2,{id:"agent-coordination-architecture",children:"Agent Coordination Architecture"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-mermaid",children:"sequenceDiagram\r\n    participant Client\r\n    participant Router as multiAgentRoutes\r\n    participant GI as GraphInvestigator\r\n    participant TM as TrafficMaestro\r\n    participant Stellio\r\n    participant Neo4j\r\n    participant External as External APIs\r\n    \r\n    Client->>Router: POST /full-analysis\r\n    \r\n    par Parallel Agent Execution\r\n        Router->>GI: investigateIncident()\r\n        GI->>Stellio: Get accident details\r\n        GI->>Neo4j: Get relationships\r\n        GI->>External: Tavily search\r\n        GI--\x3e>Router: Investigation report\r\n    and\r\n        Router->>TM: predictEventImpact()\r\n        TM->>External: Ticketmaster API\r\n        TM->>Stellio: Get traffic patterns\r\n        TM--\x3e>Router: Prediction report\r\n    end\r\n    \r\n    Router->>Router: Correlate findings\r\n    Router->>Router: Generate recommendations\r\n    Router--\x3e>Client: Combined analysis\n"})}),"\n",(0,i.jsx)(e.h2,{id:"agent-singleton-management",children:"Agent Singleton Management"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"// Singleton instances for resource efficiency\r\nlet graphInvestigator: GraphInvestigatorAgent | null = null;\r\nlet trafficMaestro: TrafficMaestroAgent | null = null;\r\n\r\nconst getGraphInvestigator = (): GraphInvestigatorAgent => {\r\n  if (!graphInvestigator) {\r\n    graphInvestigator = new GraphInvestigatorAgent();\r\n    logger.info('\u2705 GraphInvestigatorAgent initialized');\r\n  }\r\n  return graphInvestigator;\r\n};\r\n\r\nconst getTrafficMaestro = (): TrafficMaestroAgent => {\r\n  if (!trafficMaestro) {\r\n    trafficMaestro = new TrafficMaestroAgent();\r\n    logger.info('\u2705 TrafficMaestroAgent initialized');\r\n  }\r\n  return trafficMaestro;\r\n};\n"})}),"\n",(0,i.jsx)(e.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-json",children:'// 400 Bad Request\r\n{\r\n  "success": false,\r\n  "error": "Invalid accidentId. Required: string (URN format)"\r\n}\r\n\r\n// 500 Agent Error\r\n{\r\n  "success": false,\r\n  "error": "Investigation failed: Unable to retrieve accident data"\r\n}\r\n\r\n// 503 External Service Error\r\n{\r\n  "success": false,\r\n  "error": "External API (Tavily/Ticketmaster) temporarily unavailable"\r\n}\n'})}),"\n",(0,i.jsx)(e.h2,{id:"rate-limiting",children:"Rate Limiting"}),"\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"Endpoint"}),(0,i.jsx)(e.th,{children:"Limit"}),(0,i.jsx)(e.th,{children:"Window"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"/graph-investigator/*"})}),(0,i.jsx)(e.td,{children:"5 req/min"}),(0,i.jsx)(e.td,{children:"1 minute"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"/traffic-maestro/*"})}),(0,i.jsx)(e.td,{children:"5 req/min"}),(0,i.jsx)(e.td,{children:"1 minute"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"/full-analysis"})}),(0,i.jsx)(e.td,{children:"3 req/min"}),(0,i.jsx)(e.td,{children:"1 minute"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"/coordinated"})}),(0,i.jsx)(e.td,{children:"3 req/min"}),(0,i.jsx)(e.td,{children:"1 minute"})]})]})]}),"\n",(0,i.jsx)(e.h2,{id:"related-documentation",children:"Related Documentation"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.a,{href:"/tes/vi/docs/backend/agents/GraphInvestigatorAgent",children:"GraphInvestigatorAgent"})," - Multimodal analysis"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.a,{href:"/tes/vi/docs/backend/agents/TrafficMaestroAgent",children:"TrafficMaestroAgent"})," - Predictive orchestration"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.a,{href:"/tes/vi/docs/backend/routes/agent-routes",children:"Agent Routes"})," - EcoTwin endpoints"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.a,{href:"/tes/vi/docs/backend/routes/accident-routes",children:"Accident Routes"})," - Accident data API"]}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"references",children:"References"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://tavily.com/",children:"Tavily Search API"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://developer.ticketmaster.com/",children:"Ticketmaster API"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://ai.google.dev/docs",children:"Google Gemini Vision"})}),"\n"]})]})}function h(n={}){const{wrapper:e}={...(0,a.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(l,{...n})}):l(n)}}}]);