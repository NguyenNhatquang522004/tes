"use strict";(globalThis.webpackChunkuip_urban_intelligence_platform_docs=globalThis.webpackChunkuip_urban_intelligence_platform_docs||[]).push([[4949],{5107:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>h,frontMatter:()=>d,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"agents/cache/cache-invalidator","title":"cache-invalidator","description":"\x3c!--","source":"@site/docs/agents/cache/cache-invalidator.md","sourceDirName":"agents/cache","slug":"/agents/cache/cache-invalidator","permalink":"/tes/vi/docs/agents/cache/cache-invalidator","draft":false,"unlisted":false,"editUrl":"https://github.com/NguyenNhatquang522004/UIP-Urban_Intelligence_Platform/tree/main/apps/traffic-web-app/frontend/docs/docs/agents/cache/cache-invalidator.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"cache-manager","permalink":"/tes/vi/docs/agents/cache/cache-manager"},"next":{"title":"neo4j-sync","permalink":"/tes/vi/docs/agents/graph-database/neo4j-sync"}}');var t=a(4848),r=a(8453);const d={sidebar_position:2},s="Cache Invalidator Agent",l={},c=[{value:"\ud83d\udccb Overview",id:"-overview",level:2},{value:"\ud83c\udfaf Purpose",id:"-purpose",level:2},{value:"\ud83d\udd27 Invalidation Strategies",id:"-invalidation-strategies",level:2},{value:"Time-Based Invalidation (TTL)",id:"time-based-invalidation-ttl",level:3},{value:"Event-Based Invalidation",id:"event-based-invalidation",level:3},{value:"Pattern-Based Invalidation",id:"pattern-based-invalidation",level:3},{value:"Dependency-Based Invalidation",id:"dependency-based-invalidation",level:3},{value:"\ud83d\udcca Architecture",id:"-architecture",level:2},{value:"\ud83d\ude80 Usage",id:"-usage",level:2},{value:"Basic Invalidation",id:"basic-invalidation",level:3},{value:"Event-Driven Invalidation",id:"event-driven-invalidation",level:3},{value:"\u2699\ufe0f Configuration",id:"\ufe0f-configuration",level:2},{value:"\ud83d\udcc8 Metrics",id:"-metrics",level:2},{value:"\ud83d\udee1\ufe0f Best Practices",id:"\ufe0f-best-practices",level:2},{value:"1. Use Specific Keys",id:"1-use-specific-keys",level:3},{value:"2. Batch Invalidations",id:"2-batch-invalidations",level:3},{value:"3. Log Invalidations",id:"3-log-invalidations",level:3},{value:"\ud83d\udcd6 Related Documentation",id:"-related-documentation",level:2}];function o(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"cache-invalidator-agent",children:"Cache Invalidator Agent"})}),"\n",(0,t.jsx)(n.p,{children:"The Cache Invalidator Agent handles intelligent cache invalidation strategies to maintain data consistency across the platform."}),"\n",(0,t.jsx)(n.h2,{id:"-overview",children:"\ud83d\udccb Overview"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Property"}),(0,t.jsx)(n.th,{children:"Value"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Module"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"src.agents.cache.cache_invalidator_agent"})})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Class"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"CacheInvalidatorAgent"})})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Author"})}),(0,t.jsx)(n.td,{children:"Nguyen Viet Hoang"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Version"})}),(0,t.jsx)(n.td,{children:"1.0.0"})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"-purpose",children:"\ud83c\udfaf Purpose"}),"\n",(0,t.jsx)(n.p,{children:"Cache invalidation ensures data consistency by:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Removing stale data"})," when source data changes"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Propagating updates"})," across distributed cache nodes"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Maintaining consistency"})," between cache and database"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Optimizing memory"})," by removing unused entries"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"-invalidation-strategies",children:"\ud83d\udd27 Invalidation Strategies"}),"\n",(0,t.jsx)(n.h3,{id:"time-based-invalidation-ttl",children:"Time-Based Invalidation (TTL)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'# Set TTL during caching\r\ncache.set("camera:CAM_001", data, ttl=300)  # Expires in 5 minutes\n'})}),"\n",(0,t.jsx)(n.h3,{id:"event-based-invalidation",children:"Event-Based Invalidation"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'# Invalidate on data change event\r\ninvalidator.on_entity_update("camera:CAM_001")\r\ninvalidator.on_entity_delete("camera:CAM_001")\n'})}),"\n",(0,t.jsx)(n.h3,{id:"pattern-based-invalidation",children:"Pattern-Based Invalidation"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'# Invalidate all matching keys\r\ninvalidator.invalidate_pattern("observation:*")\r\ninvalidator.invalidate_pattern("camera:CAM_00*")\n'})}),"\n",(0,t.jsx)(n.h3,{id:"dependency-based-invalidation",children:"Dependency-Based Invalidation"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'# Invalidate dependent caches\r\ninvalidator.invalidate_with_dependencies("camera:CAM_001", [\r\n    "observations:CAM_001:*",\r\n    "stats:CAM_001:*"\r\n])\n'})}),"\n",(0,t.jsx)(n.h2,{id:"-architecture",children:"\ud83d\udcca Architecture"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-text",children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\r\n\u2502 Data Change     \u2502\r\n\u2502 Event           \u2502\r\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\r\n         \u2502\r\n         \u25bc\r\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\r\n\u2502   Invalidator   \u2502\u2500\u2500\u2500\u25b6\u2502  Cache Manager  \u2502\r\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\r\n         \u2502\r\n    \u250c\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2510\r\n    \u25bc         \u25bc\r\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\r\n\u2502 Redis \u2502 \u2502 Local \u2502\r\n\u2502 Cache \u2502 \u2502 Cache \u2502\r\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,t.jsx)(n.h2,{id:"-usage",children:"\ud83d\ude80 Usage"}),"\n",(0,t.jsx)(n.h3,{id:"basic-invalidation",children:"Basic Invalidation"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'from src.agents.cache.cache_invalidator_agent import CacheInvalidatorAgent\r\n\r\ninvalidator = CacheInvalidatorAgent()\r\n\r\n# Invalidate single key\r\ninvalidator.invalidate("camera:CAM_001")\r\n\r\n# Invalidate multiple keys\r\ninvalidator.invalidate_many([\r\n    "camera:CAM_001",\r\n    "camera:CAM_002"\r\n])\r\n\r\n# Invalidate by pattern\r\ninvalidator.invalidate_pattern("observation:2025-01-*")\n'})}),"\n",(0,t.jsx)(n.h3,{id:"event-driven-invalidation",children:"Event-Driven Invalidation"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'# Subscribe to entity changes\r\ninvalidator.subscribe_to_changes([\r\n    "Camera",\r\n    "Observation",\r\n    "Accident"\r\n])\r\n\r\n# Handle change event\r\ndef on_camera_update(entity_id: str):\r\n    invalidator.invalidate(f"camera:{entity_id}")\r\n    invalidator.invalidate_pattern(f"observations:{entity_id}:*")\n'})}),"\n",(0,t.jsx)(n.h2,{id:"\ufe0f-configuration",children:"\u2699\ufe0f Configuration"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"# config/cache_config.yaml\r\ncache_invalidation:\r\n  enabled: true\r\n  \r\n  # Invalidation strategies\r\n  strategies:\r\n    time_based:\r\n      default_ttl: 3600\r\n      camera_ttl: 300\r\n      observation_ttl: 60\r\n    \r\n    event_based:\r\n      enabled: true\r\n      entity_types:\r\n        - Camera\r\n        - Observation\r\n        - Accident\r\n        - Congestion\r\n    \r\n    pattern_based:\r\n      batch_size: 1000\r\n      scan_count: 100\n"})}),"\n",(0,t.jsx)(n.h2,{id:"-metrics",children:"\ud83d\udcc8 Metrics"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Metric"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"invalidations_total"})}),(0,t.jsx)(n.td,{children:"Total invalidation operations"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"invalidations_by_pattern"})}),(0,t.jsx)(n.td,{children:"Pattern-based invalidations"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"invalidation_latency"})}),(0,t.jsx)(n.td,{children:"Average invalidation time"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"cascade_invalidations"})}),(0,t.jsx)(n.td,{children:"Dependency cascade operations"})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"\ufe0f-best-practices",children:"\ud83d\udee1\ufe0f Best Practices"}),"\n",(0,t.jsx)(n.h3,{id:"1-use-specific-keys",children:"1. Use Specific Keys"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'# Good: Specific key\r\ninvalidator.invalidate("camera:CAM_001:location")\r\n\r\n# Avoid: Broad pattern\r\ninvalidator.invalidate_pattern("camera:*")\n'})}),"\n",(0,t.jsx)(n.h3,{id:"2-batch-invalidations",children:"2. Batch Invalidations"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"# Batch for better performance\r\ninvalidator.invalidate_many(key_list)\n"})}),"\n",(0,t.jsx)(n.h3,{id:"3-log-invalidations",children:"3. Log Invalidations"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"# Enable audit logging\r\ninvalidator.set_audit_logging(True)\n"})}),"\n",(0,t.jsx)(n.h2,{id:"-related-documentation",children:"\ud83d\udcd6 Related Documentation"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"cache-manager",children:"Cache Manager Agent"})," - Primary caching operations"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"../context-management/state-updater",children:"State Updater Agent"})," - State change handling"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"../context-management/entity-publisher",children:"Entity Publisher Agent"})," - Entity updates"]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsxs)(n.p,{children:["See the ",(0,t.jsx)(n.a,{href:"../complete-agents-reference",children:"complete agents reference"})," for all available agents."]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(o,{...e})}):o(e)}},8453:(e,n,a)=>{a.d(n,{R:()=>d,x:()=>s});var i=a(6540);const t={},r=i.createContext(t);function d(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:d(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);