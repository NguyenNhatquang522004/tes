"use strict";(globalThis.webpackChunkuip_urban_intelligence_platform_docs=globalThis.webpackChunkuip_urban_intelligence_platform_docs||[]).push([[3171],{2657:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"backend/services/generic-ngsi-service","title":"GenericNgsiService - Config-Driven Architecture","description":"100% config-driven NGSI-LD service that works with any entity type defined in YAML configuration files - zero hardcoded domain logic.","source":"@site/docs/backend/services/genericNgsiService.md","sourceDirName":"backend/services","slug":"/backend/services/generic-ngsi-service","permalink":"/tes/vi/docs/backend/services/generic-ngsi-service","draft":false,"unlisted":false,"editUrl":"https://github.com/NguyenNhatquang522004/UIP-Urban_Intelligence_Platform/tree/main/apps/traffic-web-app/frontend/docs/docs/backend/services/genericNgsiService.md","tags":[],"version":"current","sidebarPosition":7,"frontMatter":{"id":"generic-ngsi-service","title":"GenericNgsiService - Config-Driven Architecture","sidebar_label":"GenericNgsiService","sidebar_position":7,"description":"100% config-driven NGSI-LD service that works with any entity type defined in YAML configuration files - zero hardcoded domain logic.","keywords":["ngsi-ld","config-driven","yaml","generic","entity","transformation"]}}');var t=r(4848),s=r(8453);const a={id:"generic-ngsi-service",title:"GenericNgsiService - Config-Driven Architecture",sidebar_label:"GenericNgsiService",sidebar_position:7,description:"100% config-driven NGSI-LD service that works with any entity type defined in YAML configuration files - zero hardcoded domain logic.",keywords:["ngsi-ld","config-driven","yaml","generic","entity","transformation"]},o="GenericNgsiService - Config-Driven Architecture",l={},c=[{value:"Overview",id:"overview",level:2},{value:"Features",id:"features",level:2},{value:"Architecture",id:"architecture",level:2},{value:"Class Definition",id:"class-definition",level:2},{value:"YAML Configuration Schema",id:"yaml-configuration-schema",level:2},{value:"Entity Configuration",id:"entity-configuration",level:3},{value:"Multiple Entity Types",id:"multiple-entity-types",level:3},{value:"Usage Examples",id:"usage-examples",level:2},{value:"Basic Entity Fetching",id:"basic-entity-fetching",level:3},{value:"Filtered Queries",id:"filtered-queries",level:3},{value:"Single Entity",id:"single-entity",level:3},{value:"Field Transformation",id:"field-transformation",level:2},{value:"ngsiPath Extraction",id:"ngsipath-extraction",level:3},{value:"Type Transformations",id:"type-transformations",level:3},{value:"Computed Fields",id:"computed-fields",level:2},{value:"Expression Examples",id:"expression-examples",level:3},{value:"Entity Joins",id:"entity-joins",level:2},{value:"Benefits of Config-Driven Architecture",id:"benefits-of-config-driven-architecture",level:2},{value:"Configuration Loading",id:"configuration-loading",level:2},{value:"Error Handling",id:"error-handling",level:2},{value:"Related Documentation",id:"related-documentation",level:2},{value:"References",id:"references",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"genericngsiservice---config-driven-architecture",children:"GenericNgsiService - Config-Driven Architecture"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"100% config-driven"})," NGSI-LD service that works with ",(0,t.jsx)(n.strong,{children:"any entity type"})," defined in YAML configuration files. Zero hardcoded domain logic - all behavior driven by configuration."]}),"\n",(0,t.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-mermaid",children:'graph TB\r\n    subgraph GenericNgsiService\r\n        LOADER[Config Loader]\r\n        FETCH[Entity Fetcher]\r\n        TRANSFORM[Transformer]\r\n        FILTER[Filter Engine]\r\n        SORT[Sorter]\r\n    end\r\n    \r\n    subgraph Config["YAML Configuration"]\r\n        ENTITIES[entities.yaml]\r\n        FIELDS[field mappings]\r\n        COMPUTED[computed fields]\r\n        FILTERS[filter definitions]\r\n    end\r\n    \r\n    subgraph Stellio["Stellio Context Broker"]\r\n        API[NGSI-LD API]\r\n    end\r\n    \r\n    ENTITIES --\x3e LOADER\r\n    LOADER --\x3e FETCH\r\n    FETCH --\x3e API\r\n    API --\x3e TRANSFORM\r\n    FIELDS --\x3e TRANSFORM\r\n    COMPUTED --\x3e TRANSFORM\r\n    TRANSFORM --\x3e FILTER\r\n    FILTERS --\x3e FILTER\r\n    FILTER --\x3e SORT\n'})}),"\n",(0,t.jsx)(n.h2,{id:"features",children:"Features"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Feature"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Config-Driven"})}),(0,t.jsx)(n.td,{children:"All entity types defined in YAML"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Dynamic Mapping"})}),(0,t.jsx)(n.td,{children:"ngsiPath field extraction"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Alternative Paths"})}),(0,t.jsx)(n.td,{children:"Fallback property resolution"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Type Transformations"})}),(0,t.jsx)(n.td,{children:"GeoJSON, coordinates, dates, numbers"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Computed Fields"})}),(0,t.jsx)(n.td,{children:"Expression evaluation"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Entity Joins"})}),(0,t.jsx)(n.td,{children:"Relationship resolution"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Zero Hardcoding"})}),(0,t.jsx)(n.td,{children:"Add entities without code changes"})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"architecture",children:"Architecture"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-mermaid",children:"flowchart LR\r\n    subgraph Input\r\n        YAML[entity.yaml]\r\n        QUERY[Query Params]\r\n    end\r\n    \r\n    subgraph Processing\r\n        A[Load Config] --\x3e B[Fetch from Stellio]\r\n        B --\x3e C[Transform Fields]\r\n        C --\x3e D[Resolve Joins]\r\n        D --\x3e E[Compute Fields]\r\n        E --\x3e F[Apply Filters]\r\n        F --\x3e G[Sort Results]\r\n    end\r\n    \r\n    subgraph Output\r\n        ENTITIES[Transformed Entities]\r\n    end\r\n    \r\n    YAML --\x3e A\r\n    QUERY --\x3e F\r\n    G --\x3e ENTITIES\n"})}),"\n",(0,t.jsx)(n.h2,{id:"class-definition",children:"Class Definition"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"import axios, { AxiosInstance } from 'axios';\r\nimport { configLoader, EntityConfig, FieldConfig } from '../config/configLoader';\r\n\r\nexport class GenericNgsiService {\r\n  private stellioBaseUrl: string;\r\n  private cameraCache: Map<string, any>;\r\n  private axiosClient: AxiosInstance;\r\n\r\n  constructor();\r\n  \r\n  // Entity Operations\r\n  fetchEntities(entityName: string, queryParams?: Record<string, any>): Promise<any[]>;\r\n  fetchEntityById(entityName: string, id: string): Promise<any | null>;\r\n  \r\n  // Transformation\r\n  private transformEntity(entity: any, config: EntityConfig): Promise<any>;\r\n  private extractValue(entity: any, field: FieldConfig): any;\r\n  private resolveAlternativePaths(entity: any, paths: string[]): any;\r\n  \r\n  // Joins\r\n  private resolveJoins(entity: any, config: EntityConfig): Promise<any>;\r\n  \r\n  // Computed Fields\r\n  private computeFields(entity: any, config: EntityConfig): any;\r\n  \r\n  // Filtering & Sorting\r\n  private applyFilters(entities: any[], config: EntityConfig, params: Record<string, any>): any[];\r\n  private applySorting(entities: any[], config: EntityConfig): any[];\r\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"yaml-configuration-schema",children:"YAML Configuration Schema"}),"\n",(0,t.jsx)(n.h3,{id:"entity-configuration",children:"Entity Configuration"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'# config/entities.yaml\r\nentities:\r\n  Camera:\r\n    entityType: "Camera"\r\n    description: "Traffic monitoring camera"\r\n    \r\n    fields:\r\n      - name: id\r\n        ngsiPath: "id"\r\n        type: string\r\n        required: true\r\n        \r\n      - name: name\r\n        ngsiPath: "name.value"\r\n        alternativePaths:\r\n          - "https://uri.etsi.org/ngsi-ld/name"\r\n          - "name"\r\n        type: string\r\n        default: "Unknown Camera"\r\n        \r\n      - name: location\r\n        ngsiPath: "location.value"\r\n        type: geojson\r\n        transform: coordinates\r\n        \r\n      - name: imageUrl\r\n        ngsiPath: "image.value"\r\n        alternativePaths:\r\n          - "cameraImage.value"\r\n          - "streamUrl.value"\r\n        type: string\r\n        \r\n      - name: status\r\n        ngsiPath: "status.value"\r\n        type: string\r\n        default: "unknown"\r\n        enum: ["active", "inactive", "maintenance", "unknown"]\r\n        \r\n      - name: dateModified\r\n        ngsiPath: "dateModified"\r\n        alternativePaths:\r\n          - "modifiedAt"\r\n        type: datetime\r\n        \r\n    computed:\r\n      - name: isActive\r\n        expression: "status === \'active\'"\r\n        type: boolean\r\n        \r\n      - name: displayName\r\n        expression: "name || `Camera ${id.split(\':\').pop()}`"\r\n        type: string\r\n        \r\n    joins:\r\n      - name: roadSegment\r\n        relationshipPath: "refRoadSegment.object"\r\n        targetEntity: "RoadSegment"\r\n        \r\n    filters:\r\n      - name: status\r\n        field: status\r\n        operator: eq\r\n        \r\n      - name: active\r\n        field: isActive\r\n        operator: eq\r\n        transform: boolean\r\n        \r\n    sorting:\r\n      - field: dateModified\r\n        order: desc\n'})}),"\n",(0,t.jsx)(n.h3,{id:"multiple-entity-types",children:"Multiple Entity Types"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'entities:\r\n  Camera:\r\n    # ... camera config\r\n    \r\n  Weather:\r\n    entityType: "WeatherObserved"\r\n    fields:\r\n      - name: temperature\r\n        ngsiPath: "temperature.value"\r\n        type: number\r\n        unit: "\xb0C"\r\n        \r\n      - name: humidity\r\n        ngsiPath: "relativeHumidity.value"\r\n        type: number\r\n        unit: "%"\r\n        \r\n      - name: observedAt\r\n        ngsiPath: "dateObserved.value"\r\n        type: datetime\r\n        \r\n  AirQuality:\r\n    entityType: "AirQualityObserved"\r\n    fields:\r\n      - name: pm25\r\n        ngsiPath: "PM25.value"\r\n        alternativePaths:\r\n          - "pm2_5.value"\r\n        type: number\r\n        \r\n      - name: aqi\r\n        ngsiPath: "airQualityIndex.value"\r\n        type: number\r\n        \r\n    computed:\r\n      - name: category\r\n        expression: |\r\n          aqi <= 50 ? \'Good\' :\r\n          aqi <= 100 ? \'Moderate\' :\r\n          aqi <= 150 ? \'Unhealthy for Sensitive\' :\r\n          aqi <= 200 ? \'Unhealthy\' :\r\n          aqi <= 300 ? \'Very Unhealthy\' : \'Hazardous\'\r\n        type: string\n'})}),"\n",(0,t.jsx)(n.h2,{id:"usage-examples",children:"Usage Examples"}),"\n",(0,t.jsx)(n.h3,{id:"basic-entity-fetching",children:"Basic Entity Fetching"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"import { GenericNgsiService } from './services/genericNgsiService';\r\n\r\nconst service = new GenericNgsiService();\r\n\r\n// Fetch cameras (driven by Camera config in YAML)\r\nconst cameras = await service.fetchEntities('Camera', { limit: 100 });\r\n\r\n// Fetch weather (driven by Weather config in YAML)\r\nconst weather = await service.fetchEntities('Weather');\r\n\r\n// Fetch air quality\r\nconst airQuality = await service.fetchEntities('AirQuality');\n"})}),"\n",(0,t.jsx)(n.h3,{id:"filtered-queries",children:"Filtered Queries"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// Filter by status\r\nconst activeCameras = await service.fetchEntities('Camera', {\r\n  status: 'active'\r\n});\r\n\r\n// Filter by location\r\nconst nearbyCameras = await service.fetchEntities('Camera', {\r\n  near: '10.77,106.70',\r\n  radius: 5000\r\n});\r\n\r\n// Multiple filters\r\nconst filtered = await service.fetchEntities('AirQuality', {\r\n  aqi: { gt: 100 },\r\n  category: 'Unhealthy'\r\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"single-entity",children:"Single Entity"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// Get by ID\r\nconst camera = await service.fetchEntityById(\r\n  'Camera',\r\n  'urn:ngsi-ld:Camera:001'\r\n);\r\n\r\nif (camera) {\r\n  console.log(camera.name);\r\n  console.log(camera.isActive);  // Computed field\r\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"field-transformation",children:"Field Transformation"}),"\n",(0,t.jsx)(n.h3,{id:"ngsipath-extraction",children:"ngsiPath Extraction"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"private extractValue(entity: any, field: FieldConfig): any {\r\n  // Try primary path\r\n  let value = this.getNestedValue(entity, field.ngsiPath);\r\n  \r\n  // Try alternative paths if primary fails\r\n  if (value === undefined && field.alternativePaths) {\r\n    for (const altPath of field.alternativePaths) {\r\n      value = this.getNestedValue(entity, altPath);\r\n      if (value !== undefined) break;\r\n    }\r\n  }\r\n  \r\n  // Apply default if still undefined\r\n  if (value === undefined && field.default !== undefined) {\r\n    value = field.default;\r\n  }\r\n  \r\n  // Apply type transformation\r\n  return this.transformValue(value, field.type);\r\n}\r\n\r\nprivate getNestedValue(obj: any, path: string): any {\r\n  return path.split('.').reduce((current, key) => \r\n    current?.[key], obj\r\n  );\r\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"type-transformations",children:"Type Transformations"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Type"}),(0,t.jsx)(n.th,{children:"Input"}),(0,t.jsx)(n.th,{children:"Output"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"string"})}),(0,t.jsx)(n.td,{children:"Any"}),(0,t.jsx)(n.td,{children:"String value"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"number"})}),(0,t.jsx)(n.td,{children:"String/Number"}),(0,t.jsx)(n.td,{children:"Number"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"boolean"})}),(0,t.jsx)(n.td,{children:"String/Boolean"}),(0,t.jsx)(n.td,{children:"Boolean"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"datetime"})}),(0,t.jsx)(n.td,{children:"ISO string"}),(0,t.jsx)(n.td,{children:"Date object"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"geojson"})}),(0,t.jsx)(n.td,{children:"GeoJSON object"}),(0,t.jsx)(n.td,{children:"Object with latitude, longitude"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"coordinates"})}),(0,t.jsx)(n.td,{children:"[lon, lat] array"}),(0,t.jsx)(n.td,{children:"Object with latitude, longitude"})]})]})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"private transformValue(value: any, type: string): any {\r\n  switch (type) {\r\n    case 'number':\r\n      return parseFloat(value);\r\n      \r\n    case 'boolean':\r\n      return value === true || value === 'true';\r\n      \r\n    case 'datetime':\r\n      return new Date(value);\r\n      \r\n    case 'geojson':\r\n    case 'coordinates':\r\n      if (value?.type === 'Point') {\r\n        return {\r\n          latitude: value.coordinates[1],\r\n          longitude: value.coordinates[0]\r\n        };\r\n      }\r\n      return value;\r\n      \r\n    default:\r\n      return value;\r\n  }\r\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"computed-fields",children:"Computed Fields"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"private computeFields(entity: any, config: EntityConfig): any {\r\n  if (!config.computed) return entity;\r\n  \r\n  for (const computed of config.computed) {\r\n    try {\r\n      // Create evaluation context with entity fields\r\n      const context = { ...entity };\r\n      \r\n      // Evaluate expression\r\n      const fn = new Function(...Object.keys(context), `return ${computed.expression}`);\r\n      entity[computed.name] = fn(...Object.values(context));\r\n    } catch (error) {\r\n      logger.warn(`Failed to compute ${computed.name}:`, error);\r\n      entity[computed.name] = null;\r\n    }\r\n  }\r\n  \r\n  return entity;\r\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"expression-examples",children:"Expression Examples"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"computed:\r\n  # Simple boolean\r\n  - name: isActive\r\n    expression: \"status === 'active'\"\r\n    \r\n  # Conditional\r\n  - name: severity\r\n    expression: \"casualties > 5 ? 'critical' : casualties > 0 ? 'serious' : 'minor'\"\r\n    \r\n  # String manipulation\r\n  - name: shortId\r\n    expression: \"id.split(':').pop()\"\r\n    \r\n  # Numeric calculation\r\n  - name: speedPercentile\r\n    expression: \"Math.round((avgSpeed / 60) * 100)\"\r\n    \r\n  # AQI category\r\n  - name: aqiCategory\r\n    expression: |\r\n      aqi <= 50 ? 'Good' :\r\n      aqi <= 100 ? 'Moderate' :\r\n      aqi <= 150 ? 'USG' : 'Unhealthy'\n"})}),"\n",(0,t.jsx)(n.h2,{id:"entity-joins",children:"Entity Joins"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"private async resolveJoins(entity: any, config: EntityConfig): Promise<any> {\r\n  if (!config.joins) return entity;\r\n  \r\n  for (const join of config.joins) {\r\n    const relationshipId = this.getNestedValue(entity, join.relationshipPath);\r\n    \r\n    if (relationshipId) {\r\n      try {\r\n        // Fetch related entity\r\n        const related = await this.fetchEntityById(join.targetEntity, relationshipId);\r\n        entity[join.name] = related;\r\n      } catch (error) {\r\n        logger.warn(`Failed to resolve join ${join.name}:`, error);\r\n        entity[join.name] = null;\r\n      }\r\n    }\r\n  }\r\n  \r\n  return entity;\r\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"benefits-of-config-driven-architecture",children:"Benefits of Config-Driven Architecture"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-mermaid",children:"graph TB\r\n    subgraph Traditional\r\n        CODE1[Entity A Code] --\x3e DB\r\n        CODE2[Entity B Code] --\x3e DB\r\n        CODE3[Entity C Code] --\x3e DB\r\n    end\r\n    \r\n    subgraph Config-Driven\r\n        CONFIG[entities.yaml] --\x3e GENERIC[GenericNgsiService]\r\n        GENERIC --\x3e DB2[(Stellio)]\r\n    end\r\n    \r\n    style CONFIG fill:#c8e6c9\r\n    style GENERIC fill:#c8e6c9\n"})}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Aspect"}),(0,t.jsx)(n.th,{children:"Traditional"}),(0,t.jsx)(n.th,{children:"Config-Driven"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Add new entity"}),(0,t.jsx)(n.td,{children:"Write new service"}),(0,t.jsx)(n.td,{children:"Add YAML config"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Change field mapping"}),(0,t.jsx)(n.td,{children:"Modify code"}),(0,t.jsx)(n.td,{children:"Edit YAML"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Deployment"}),(0,t.jsx)(n.td,{children:"Rebuild & redeploy"}),(0,t.jsx)(n.td,{children:"Restart service"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Consistency"}),(0,t.jsx)(n.td,{children:"Varies per entity"}),(0,t.jsx)(n.td,{children:"Guaranteed"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Testing"}),(0,t.jsx)(n.td,{children:"Per-entity tests"}),(0,t.jsx)(n.td,{children:"Generic tests"})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"configuration-loading",children:"Configuration Loading"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// config/configLoader.ts\r\nimport yaml from 'js-yaml';\r\nimport fs from 'fs';\r\n\r\nexport interface EntityConfig {\r\n  entityType: string;\r\n  description?: string;\r\n  fields: FieldConfig[];\r\n  computed?: ComputationConfig[];\r\n  joins?: JoinConfig[];\r\n  filters?: FilterConfig[];\r\n  sorting?: SortConfig[];\r\n}\r\n\r\nexport interface FieldConfig {\r\n  name: string;\r\n  ngsiPath: string;\r\n  alternativePaths?: string[];\r\n  type: string;\r\n  required?: boolean;\r\n  default?: any;\r\n  enum?: string[];\r\n}\r\n\r\nexport class ConfigLoader {\r\n  private config: any;\r\n  \r\n  load(): any {\r\n    const configPath = process.env.CONFIG_PATH || './config/entities.yaml';\r\n    const content = fs.readFileSync(configPath, 'utf8');\r\n    this.config = yaml.load(content);\r\n    return this.config;\r\n  }\r\n  \r\n  getEntityConfig(entityName: string): EntityConfig | undefined {\r\n    return this.config.entities[entityName];\r\n  }\r\n}\r\n\r\nexport const configLoader = new ConfigLoader();\n"})}),"\n",(0,t.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"public async fetchEntities(entityName: string, queryParams?: Record<string, any>): Promise<any[]> {\r\n  const entityConfig = configLoader.getEntityConfig(entityName);\r\n\r\n  if (!entityConfig) {\r\n    throw new Error(`Entity configuration not found: ${entityName}`);\r\n  }\r\n\r\n  try {\r\n    const response = await this.axiosClient.get(stellioUrl, {\r\n      headers: {\r\n        'Accept': 'application/ld+json',\r\n        'Link': '<https://uri.etsi.org/ngsi-ld/v1/ngsi-ld-core-context.jsonld>; rel=\"http://www.w3.org/ns/json-ld#context\"; type=\"application/ld+json\"'\r\n      }\r\n    });\r\n\r\n    // Transform and filter...\r\n  } catch (error) {\r\n    if (axios.isAxiosError(error)) {\r\n      logger.error(`Stellio request failed for ${entityName}: ${error.message}`);\r\n      throw new Error(`Failed to fetch ${entityName} entities`);\r\n    }\r\n    throw error;\r\n  }\r\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"related-documentation",children:"Related Documentation"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/tes/vi/docs/backend/services/stellio-service",children:"StellioService"})," - Low-level NGSI-LD client"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/tes/vi/docs/backend/config/config-loader",children:"Config Loader"})," - YAML configuration loading"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/tes/vi/docs/backend/overview",children:"Backend Overview"})," - Architecture overview"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://www.etsi.org/deliver/etsi_gs/CIM/001_099/009/01.06.01_60/gs_cim009v010601p.pdf",children:"NGSI-LD Specification"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://yaml.org/spec/1.2.2/",children:"YAML Specification"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://github.com/nodeca/js-yaml",children:"js-yaml Library"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>a,x:()=>o});var i=r(6540);const t={},s=i.createContext(t);function a(e){const n=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);