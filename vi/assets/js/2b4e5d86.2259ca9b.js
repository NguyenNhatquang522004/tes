"use strict";(globalThis.webpackChunkuip_urban_intelligence_platform_docs=globalThis.webpackChunkuip_urban_intelligence_platform_docs||[]).push([[7295],{3954:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>p,frontMatter:()=>i,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"devops/complete-devops-guide","title":"complete-devops-guide","description":"\x3c!--","source":"@site/docs/devops/complete-devops-guide.md","sourceDirName":"devops","slug":"/devops/complete-devops-guide","permalink":"/tes/vi/docs/devops/complete-devops-guide","draft":false,"unlisted":false,"editUrl":"https://github.com/NguyenNhatquang522004/UIP-Urban_Intelligence_Platform/tree/main/apps/traffic-web-app/frontend/docs/docs/devops/complete-devops-guide.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"complete-standards","permalink":"/tes/vi/docs/data-models/complete-standards"},"next":{"title":"complete-testing-guide","permalink":"/tes/vi/docs/testing/complete-testing-guide"}}');var r=s(4848),a=s(8453);const i={},o="Complete DevOps & Deployment Guide",c={},l=[{value:"Overview",id:"overview",level:2},{value:"Table of Contents",id:"table-of-contents",level:2},{value:"Docker Setup",id:"docker-setup",level:3},{value:"Kubernetes Deployment",id:"kubernetes-deployment",level:3},{value:"Helm Charts",id:"helm-charts",level:3},{value:"CI/CD Pipelines",id:"cicd-pipelines",level:3},{value:"Monitoring &amp; Observability",id:"monitoring--observability",level:3},{value:"Security",id:"security",level:3},{value:"Scaling &amp; Performance",id:"scaling--performance",level:3},{value:"Backup &amp; Recovery",id:"backup--recovery",level:3},{value:"Dockerfiles",id:"dockerfiles",level:2},{value:"Backend API Dockerfile",id:"backend-api-dockerfile",level:3},{value:"Frontend Dockerfile",id:"frontend-dockerfile",level:3},{value:"YOLOX Detection Service Dockerfile",id:"yolox-detection-service-dockerfile",level:3},{value:"Docker Compose",id:"docker-compose",level:2},{value:"Complete Docker Compose Configuration",id:"complete-docker-compose-configuration",level:3},{value:"Cluster Architecture",id:"cluster-architecture",level:2},{value:"Architecture Diagram",id:"architecture-diagram",level:3},{value:"K8s Deployments",id:"k8s-deployments",level:2},{value:"Backend Deployment",id:"backend-deployment",level:3},{value:"Frontend Deployment",id:"frontend-deployment",level:3},{value:"K8s Services",id:"k8s-services",level:2},{value:"Backend Service",id:"backend-service",level:3},{value:"Frontend Service",id:"frontend-service",level:3},{value:"ConfigMaps &amp; Secrets",id:"configmaps--secrets",level:2},{value:"ConfigMap",id:"configmap",level:3},{value:"Secrets",id:"secrets",level:3},{value:"Ingress",id:"ingress",level:2},{value:"NGINX Ingress Configuration",id:"nginx-ingress-configuration",level:3},{value:"StatefulSets",id:"statefulsets",level:2},{value:"PostgreSQL StatefulSet",id:"postgresql-statefulset",level:3},{value:"GitHub Actions",id:"github-actions",level:2},{value:"Complete CI/CD Workflow",id:"complete-cicd-workflow",level:3},{value:"Monitoring &amp; Observability",id:"monitoring--observability-1",level:2},{value:"Prometheus Configuration",id:"prometheus-configuration",level:3},{value:"Grafana Dashboard",id:"grafana-dashboard",level:3},{value:"Security",id:"security-1",level:2},{value:"RBAC Configuration",id:"rbac-configuration",level:3},{value:"Network Policy",id:"network-policy",level:3},{value:"Scaling &amp; Performance",id:"scaling--performance-1",level:2},{value:"Horizontal Pod Autoscaler",id:"horizontal-pod-autoscaler",level:3},{value:"Backup &amp; Recovery",id:"backup--recovery-1",level:2},{value:"PostgreSQL Backup CronJob",id:"postgresql-backup-cronjob",level:3},{value:"Related Documentation",id:"related-documentation",level:2},{value:"License",id:"license",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"complete-devops--deployment-guide",children:"Complete DevOps & Deployment Guide"})}),"\n",(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsx)(n.p,{children:"Comprehensive guide for deploying, monitoring, and maintaining the HCMC Traffic Management System using Docker, Kubernetes, CI/CD pipelines, monitoring tools, and security best practices."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Technologies:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Containerization"}),": Docker, Docker Compose"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Orchestration"}),": Kubernetes, Helm"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"CI/CD"}),": GitHub Actions, Jenkins"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Monitoring"}),": Prometheus, Grafana, ELK Stack"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Service Mesh"}),": Istio"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Security"}),": HashiCorp Vault, SOPS, TLS/mTLS"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"table-of-contents",children:"Table of Contents"}),"\n",(0,r.jsx)(n.h3,{id:"docker-setup",children:(0,r.jsx)(n.a,{href:"#docker-setup",children:"Docker Setup"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#dockerfiles",children:"Dockerfiles"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#docker-compose",children:"Docker Compose"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#multi-stage-builds",children:"Multi-Stage Builds"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#image-optimization",children:"Image Optimization"})}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"kubernetes-deployment",children:(0,r.jsx)(n.a,{href:"#kubernetes-deployment",children:"Kubernetes Deployment"})}),"\n",(0,r.jsxs)(n.ol,{start:"5",children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#cluster-architecture",children:"Cluster Architecture"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#k8s-deployments",children:"Deployments"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#k8s-services",children:"Services"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#configmaps-secrets",children:"ConfigMaps & Secrets"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#ingress",children:"Ingress"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#statefulsets",children:"StatefulSets"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#persistent-volumes",children:"Persistent Volumes"})}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"helm-charts",children:(0,r.jsx)(n.a,{href:"#helm-charts",children:"Helm Charts"})}),"\n",(0,r.jsxs)(n.ol,{start:"12",children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#chart-structure",children:"Chart Structure"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#values-configuration",children:"Values Configuration"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#chart-dependencies",children:"Dependencies"})}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"cicd-pipelines",children:(0,r.jsx)(n.a,{href:"#cicd-pipelines",children:"CI/CD Pipelines"})}),"\n",(0,r.jsxs)(n.ol,{start:"15",children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#github-actions",children:"GitHub Actions"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#jenkins-pipeline",children:"Jenkins Pipeline"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#build-test",children:"Build & Test"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#security-scanning",children:"Security Scanning"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#deployment-automation",children:"Deployment Automation"})}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"monitoring--observability",children:(0,r.jsx)(n.a,{href:"#monitoring-observability",children:"Monitoring & Observability"})}),"\n",(0,r.jsxs)(n.ol,{start:"20",children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#prometheus-setup",children:"Prometheus Setup"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#grafana-dashboards",children:"Grafana Dashboards"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#elk-stack",children:"Logging (ELK)"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#distributed-tracing",children:"Distributed Tracing"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#alert-manager",children:"Alert Manager"})}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"security",children:(0,r.jsx)(n.a,{href:"#security",children:"Security"})}),"\n",(0,r.jsxs)(n.ol,{start:"25",children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#secrets-management",children:"Secrets Management"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#tls-mtls",children:"TLS/mTLS"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#network-policies",children:"Network Policies"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#rbac",children:"RBAC"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#vulnerability-scanning",children:"Vulnerability Scanning"})}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"scaling--performance",children:(0,r.jsx)(n.a,{href:"#scaling-performance",children:"Scaling & Performance"})}),"\n",(0,r.jsxs)(n.ol,{start:"30",children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#hpa",children:"Horizontal Pod Autoscaling"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#vpa",children:"Vertical Pod Autoscaling"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#load-balancing",children:"Load Balancing"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#caching-strategies",children:"Caching Strategies"})}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"backup--recovery",children:(0,r.jsx)(n.a,{href:"#backup-recovery",children:"Backup & Recovery"})}),"\n",(0,r.jsxs)(n.ol,{start:"34",children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#database-backups",children:"Database Backups"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#disaster-recovery",children:"Disaster Recovery"})}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h1,{id:"docker-setup-1",children:"Docker Setup"}),"\n",(0,r.jsx)(n.h2,{id:"dockerfiles",children:"Dockerfiles"}),"\n",(0,r.jsx)(n.h3,{id:"backend-api-dockerfile",children:"Backend API Dockerfile"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-dockerfile",children:'# Multi-stage build for Python backend\nFROM python:3.9-slim as builder\n\n# Set working directory\nWORKDIR /app\n\n# Install build dependencies\nRUN apt-get update && apt-get install -y --no-install-recommends \\\n    gcc \\\n    g++ \\\n    make \\\n    libpq-dev \\\n    && rm -rf /var/lib/apt/lists/*\n\n# Copy requirements\nCOPY requirements/production.txt requirements.txt\n\n# Install Python dependencies\nRUN pip install --no-cache-dir --user -r requirements.txt\n\n# Final stage\nFROM python:3.9-slim\n\nWORKDIR /app\n\n# Install runtime dependencies\nRUN apt-get update && apt-get install -y --no-install-recommends \\\n    libpq5 \\\n    && rm -rf /var/lib/apt/lists/*\n\n# Copy Python dependencies from builder\nCOPY --from=builder /root/.local /root/.local\n\n# Make sure scripts in .local are usable\nENV PATH=/root/.local/bin:$PATH\n\n# Copy application code\nCOPY src/ ./src/\nCOPY agents/ ./agents/\nCOPY config/ ./config/\n\n# Create non-root user\nRUN useradd -m -u 1000 appuser && chown -R appuser:appuser /app\nUSER appuser\n\n# Expose port\nEXPOSE 8000\n\n# Health check\nHEALTHCHECK --interval=30s --timeout=10s --start-period=40s --retries=3 \\\n  CMD python -c "import requests; requests.get(\'http://localhost:8000/health\')"\n\n# Run application\nCMD ["uvicorn", "src.main:app", "--host", "0.0.0.0", "--port", "8000"]\n'})}),"\n",(0,r.jsx)(n.h3,{id:"frontend-dockerfile",children:"Frontend Dockerfile"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-dockerfile",children:'# Build stage\nFROM node:20-alpine as builder\n\nWORKDIR /app\n\n# Copy package files\nCOPY package*.json ./\nCOPY apps/traffic-web-app/frontend/package*.json apps/traffic-web-app/frontend/\n\n# Install dependencies\nRUN npm ci\n\n# Copy source code\nCOPY apps/traffic-web-app/frontend/ apps/traffic-web-app/frontend/\n\n# Build application\nWORKDIR /app/apps/traffic-web-app/frontend\nRUN npm run build\n\n# Production stage\nFROM nginx:alpine\n\n# Copy nginx configuration\nCOPY apps/traffic-web-app/frontend/nginx.conf /etc/nginx/nginx.conf\n\n# Copy built assets\nCOPY --from=builder /app/apps/traffic-web-app/frontend/build /usr/share/nginx/html\n\n# Create non-root user\nRUN addgroup -g 1000 nginx && adduser -D -u 1000 -G nginx nginx\n\n# Expose port\nEXPOSE 80\n\n# Health check\nHEALTHCHECK --interval=30s --timeout=5s --start-period=30s --retries=3 \\\n  CMD wget --quiet --tries=1 --spider http://localhost/health || exit 1\n\n# Run nginx\nCMD ["nginx", "-g", "daemon off;"]\n'})}),"\n",(0,r.jsx)(n.h3,{id:"yolox-detection-service-dockerfile",children:"YOLOX Detection Service Dockerfile"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-dockerfile",children:'FROM pytorch/pytorch:2.0.1-cuda11.7-cudnn8-runtime\n\nWORKDIR /app\n\n# Install system dependencies\nRUN apt-get update && apt-get install -y --no-install-recommends \\\n    libgl1-mesa-glx \\\n    libglib2.0-0 \\\n    && rm -rf /var/lib/apt/lists/*\n\n# Install Python dependencies\nCOPY requirements/base.txt requirements.txt\nRUN pip install --no-cache-dir -r requirements.txt\n\n# Download YOLOX model and DETR from HuggingFace\nRUN python -c "from transformers import AutoModelForObjectDetection; AutoModelForObjectDetection.from_pretrained(\'hilmantm/detr-traffic-accident-detection\')"\n\n# Copy application code\nCOPY agents/accident_detection.py .\nCOPY agents/cv_analysis.py .\n\nEXPOSE 8001\n\nCMD ["python", "accident_detection.py"]\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"docker-compose",children:"Docker Compose"}),"\n",(0,r.jsx)(n.h3,{id:"complete-docker-compose-configuration",children:"Complete Docker Compose Configuration"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'version: \'3.8\'\n\nservices:\n  # PostgreSQL Database\n  postgres:\n    image: postgres:15-alpine\n    container_name: traffic-postgres\n    environment:\n      POSTGRES_DB: traffic_db\n      POSTGRES_USER: traffic_user\n      POSTGRES_PASSWORD_FILE: /run/secrets/postgres_password\n    volumes:\n      - postgres-data:/var/lib/postgresql/data\n      - ./init-scripts:/docker-entrypoint-initdb.d\n    ports:\n      - "5432:5432"\n    networks:\n      - traffic-network\n    secrets:\n      - postgres_password\n    healthcheck:\n      test: ["CMD-SHELL", "pg_isready -U traffic_user"]\n      interval: 10s\n      timeout: 5s\n      retries: 5\n    restart: unless-stopped\n\n  # Redis Cache\n  redis:\n    image: redis:7-alpine\n    container_name: traffic-redis\n    command: redis-server --requirepass ${REDIS_PASSWORD}\n    volumes:\n      - redis-data:/data\n    ports:\n      - "6379:6379"\n    networks:\n      - traffic-network\n    healthcheck:\n      test: ["CMD", "redis-cli", "ping"]\n      interval: 10s\n      timeout: 5s\n      retries: 5\n    restart: unless-stopped\n\n  # MongoDB\n  mongodb:\n    image: mongo:6.0\n    container_name: traffic-mongodb\n    environment:\n      MONGO_INITDB_ROOT_USERNAME: admin\n      MONGO_INITDB_ROOT_PASSWORD_FILE: /run/secrets/mongo_password\n    volumes:\n      - mongo-data:/data/db\n    ports:\n      - "27017:27017"\n    networks:\n      - traffic-network\n    secrets:\n      - mongo_password\n    restart: unless-stopped\n\n  # Neo4j Graph Database\n  neo4j:\n    image: neo4j:5.11\n    container_name: traffic-neo4j\n    environment:\n      NEO4J_AUTH: neo4j/${NEO4J_PASSWORD}\n      NEO4J_PLUGINS: \'["apoc", "graph-data-science"]\'\n    volumes:\n      - neo4j-data:/data\n      - neo4j-logs:/logs\n    ports:\n      - "7474:7474"\n      - "7687:7687"\n    networks:\n      - traffic-network\n    restart: unless-stopped\n\n  # Apache Jena Fuseki (RDF Triplestore)\n  fuseki:\n    image: stain/jena-fuseki:4.9.0\n    container_name: traffic-fuseki\n    environment:\n      ADMIN_PASSWORD_FILE: /run/secrets/fuseki_password\n      JVM_ARGS: "-Xmx2g"\n    volumes:\n      - fuseki-data:/fuseki\n    ports:\n      - "3030:3030"\n    networks:\n      - traffic-network\n    secrets:\n      - fuseki_password\n    restart: unless-stopped\n\n  # Stellio Context Broker (NGSI-LD)\n  stellio:\n    image: stellio/stellio-context-broker:latest\n    container_name: traffic-stellio\n    environment:\n      SPRING_PROFILES_ACTIVE: docker\n      SPRING_DATASOURCE_URL: jdbc:postgresql://postgres:5432/stellio_db\n      SPRING_DATASOURCE_USERNAME: stellio\n      SPRING_DATASOURCE_PASSWORD_FILE: /run/secrets/stellio_db_password\n    ports:\n      - "8080:8080"\n    networks:\n      - traffic-network\n    secrets:\n      - stellio_db_password\n    depends_on:\n      postgres:\n        condition: service_healthy\n    restart: unless-stopped\n\n  # Kafka\n  kafka:\n    image: confluentinc/cp-kafka:7.5.0\n    container_name: traffic-kafka\n    environment:\n      KAFKA_BROKER_ID: 1\n      KAFKA_ZOOKEEPER_CONNECT: zookeeper:2181\n      KAFKA_ADVERTISED_LISTENERS: PLAINTEXT://kafka:9092\n      KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR: 1\n    ports:\n      - "9092:9092"\n    networks:\n      - traffic-network\n    depends_on:\n      - zookeeper\n    restart: unless-stopped\n\n  zookeeper:\n    image: confluentinc/cp-zookeeper:7.5.0\n    container_name: traffic-zookeeper\n    environment:\n      ZOOKEEPER_CLIENT_PORT: 2181\n      ZOOKEEPER_TICK_TIME: 2000\n    networks:\n      - traffic-network\n    restart: unless-stopped\n\n  # Backend API\n  backend:\n    build:\n      context: .\n      dockerfile: Dockerfile\n    container_name: traffic-backend\n    environment:\n      DATABASE_URL: postgresql://traffic_user:${POSTGRES_PASSWORD}@postgres:5432/traffic_db\n      REDIS_URL: redis://:${REDIS_PASSWORD}@redis:6379/0\n      MONGODB_URL: mongodb://admin:${MONGO_PASSWORD}@mongodb:27017/\n      NEO4J_URI: bolt://neo4j:7687\n      NEO4J_USER: neo4j\n      NEO4J_PASSWORD: ${NEO4J_PASSWORD}\n      FUSEKI_URL: http://fuseki:3030\n      STELLIO_URL: http://stellio:8080\n      KAFKA_BOOTSTRAP_SERVERS: kafka:9092\n    ports:\n      - "8000:8000"\n    networks:\n      - traffic-network\n    depends_on:\n      postgres:\n        condition: service_healthy\n      redis:\n        condition: service_healthy\n      mongodb:\n        condition: service_started\n      neo4j:\n        condition: service_started\n      fuseki:\n        condition: service_started\n      stellio:\n        condition: service_started\n      kafka:\n        condition: service_started\n    volumes:\n      - ./config:/app/config:ro\n      - ./data:/app/data\n      - ./logs:/app/logs\n    restart: unless-stopped\n\n  # YOLOX Detection Service\n  yolox-detector:\n    build:\n      context: .\n      dockerfile: Dockerfile.yolox\n    container_name: traffic-yolox\n    runtime: nvidia\n    environment:\n      CUDA_VISIBLE_DEVICES: 0\n    ports:\n      - "8001:8001"\n    networks:\n      - traffic-network\n    volumes:\n      - ./models:/app/models:ro\n    deploy:\n      resources:\n        reservations:\n          devices:\n            - driver: nvidia\n              count: 1\n              capabilities: [gpu]\n    restart: unless-stopped\n\n  # Frontend\n  frontend:\n    build:\n      context: .\n      dockerfile: apps/traffic-web-app/frontend/Dockerfile\n    container_name: traffic-frontend\n    ports:\n      - "3000:80"\n    networks:\n      - traffic-network\n    environment:\n      REACT_APP_API_URL: http://backend:8000\n      REACT_APP_WS_URL: ws://backend:8000/ws\n    depends_on:\n      - backend\n    restart: unless-stopped\n\n  # Prometheus\n  prometheus:\n    image: prom/prometheus:latest\n    container_name: traffic-prometheus\n    volumes:\n      - ./monitoring/prometheus.yml:/etc/prometheus/prometheus.yml:ro\n      - prometheus-data:/prometheus\n    ports:\n      - "9090:9090"\n    networks:\n      - traffic-network\n    command:\n      - \'--config.file=/etc/prometheus/prometheus.yml\'\n      - \'--storage.tsdb.path=/prometheus\'\n    restart: unless-stopped\n\n  # Grafana\n  grafana:\n    image: grafana/grafana:latest\n    container_name: traffic-grafana\n    environment:\n      GF_SECURITY_ADMIN_PASSWORD_FILE: /run/secrets/grafana_password\n      GF_INSTALL_PLUGINS: grafana-worldmap-panel\n    volumes:\n      - grafana-data:/var/lib/grafana\n      - ./monitoring/grafana/dashboards:/etc/grafana/provisioning/dashboards:ro\n      - ./monitoring/grafana/datasources:/etc/grafana/provisioning/datasources:ro\n    ports:\n      - "3001:3000"\n    networks:\n      - traffic-network\n    secrets:\n      - grafana_password\n    depends_on:\n      - prometheus\n    restart: unless-stopped\n\nnetworks:\n  traffic-network:\n    driver: bridge\n    ipam:\n      config:\n        - subnet: 172.25.0.0/16\n\nvolumes:\n  postgres-data:\n  redis-data:\n  mongo-data:\n  neo4j-data:\n  neo4j-logs:\n  fuseki-data:\n  prometheus-data:\n  grafana-data:\n\nsecrets:\n  postgres_password:\n    file: ./secrets/postgres_password.txt\n  mongo_password:\n    file: ./secrets/mongo_password.txt\n  fuseki_password:\n    file: ./secrets/fuseki_password.txt\n  stellio_db_password:\n    file: ./secrets/stellio_db_password.txt\n  grafana_password:\n    file: ./secrets/grafana_password.txt\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h1,{id:"kubernetes-deployment-1",children:"Kubernetes Deployment"}),"\n",(0,r.jsx)(n.h2,{id:"cluster-architecture",children:"Cluster Architecture"}),"\n",(0,r.jsx)(n.h3,{id:"architecture-diagram",children:"Architecture Diagram"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-mermaid",children:"graph TB\n    subgraph Internet\n        Users[Users]\n    end\n    \n    subgraph Kubernetes Cluster\n        subgraph Ingress Layer\n            Ingress[NGINX Ingress]\n            CertManager[Cert Manager]\n        end\n        \n        subgraph Application Layer\n            Frontend[Frontend Pods]\n            Backend[Backend API Pods]\n            YOLOService[YOLO Detection Pods]\n        end\n        \n        subgraph Data Layer\n            Postgres[PostgreSQL StatefulSet]\n            Redis[Redis StatefulSet]\n            MongoDB[MongoDB StatefulSet]\n            Neo4j[Neo4j StatefulSet]\n            Fuseki[Fuseki StatefulSet]\n        end\n        \n        subgraph Monitoring\n            Prometheus[Prometheus]\n            Grafana[Grafana]\n        end\n    end\n    \n    Users --\x3e|HTTPS| Ingress\n    Ingress --\x3e Frontend\n    Ingress --\x3e Backend\n    Backend --\x3e YOLOService\n    Backend --\x3e Postgres\n    Backend --\x3e Redis\n    Backend --\x3e MongoDB\n    Backend --\x3e Neo4j\n    Backend --\x3e Fuseki\n    Prometheus --\x3e Backend\n    Prometheus --\x3e Postgres\n    Grafana --\x3e Prometheus\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"k8s-deployments",children:"K8s Deployments"}),"\n",(0,r.jsx)(n.h3,{id:"backend-deployment",children:"Backend Deployment"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: traffic-backend\n  namespace: traffic-system\n  labels:\n    app: traffic-backend\n    tier: backend\nspec:\n  replicas: 3\n  strategy:\n    type: RollingUpdate\n    rollingUpdate:\n      maxSurge: 1\n      maxUnavailable: 0\n  selector:\n    matchLabels:\n      app: traffic-backend\n  template:\n    metadata:\n      labels:\n        app: traffic-backend\n        tier: backend\n      annotations:\n        prometheus.io/scrape: "true"\n        prometheus.io/port: "8000"\n        prometheus.io/path: "/metrics"\n    spec:\n      serviceAccountName: traffic-backend-sa\n      securityContext:\n        runAsNonRoot: true\n        runAsUser: 1000\n        fsGroup: 1000\n      containers:\n      - name: backend\n        image: traffic.azurecr.io/traffic-backend:v1.0.0\n        imagePullPolicy: IfNotPresent\n        ports:\n        - containerPort: 8000\n          name: http\n          protocol: TCP\n        env:\n        - name: DATABASE_URL\n          valueFrom:\n            secretKeyRef:\n              name: postgres-secret\n              key: url\n        - name: REDIS_URL\n          valueFrom:\n            secretKeyRef:\n              name: redis-secret\n              key: url\n        - name: LOG_LEVEL\n          valueFrom:\n            configMapKeyRef:\n              name: traffic-config\n              key: log_level\n        resources:\n          requests:\n            memory: "512Mi"\n            cpu: "500m"\n          limits:\n            memory: "1Gi"\n            cpu: "1000m"\n        livenessProbe:\n          httpGet:\n            path: /health\n            port: 8000\n          initialDelaySeconds: 30\n          periodSeconds: 10\n          timeoutSeconds: 5\n          failureThreshold: 3\n        readinessProbe:\n          httpGet:\n            path: /ready\n            port: 8000\n          initialDelaySeconds: 10\n          periodSeconds: 5\n          timeoutSeconds: 3\n          failureThreshold: 3\n        volumeMounts:\n        - name: config\n          mountPath: /app/config\n          readOnly: true\n        - name: data\n          mountPath: /app/data\n      volumes:\n      - name: config\n        configMap:\n          name: traffic-config\n      - name: data\n        persistentVolumeClaim:\n          claimName: backend-data-pvc\n      nodeSelector:\n        workload: backend\n      affinity:\n        podAntiAffinity:\n          preferredDuringSchedulingIgnoredDuringExecution:\n          - weight: 100\n            podAffinityTerm:\n              labelSelector:\n                matchExpressions:\n                - key: app\n                  operator: In\n                  values:\n                  - traffic-backend\n              topologyKey: kubernetes.io/hostname\n'})}),"\n",(0,r.jsx)(n.h3,{id:"frontend-deployment",children:"Frontend Deployment"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: traffic-frontend\n  namespace: traffic-system\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: traffic-frontend\n  template:\n    metadata:\n      labels:\n        app: traffic-frontend\n        tier: frontend\n    spec:\n      containers:\n      - name: frontend\n        image: traffic.azurecr.io/traffic-frontend:v1.0.0\n        ports:\n        - containerPort: 80\n        resources:\n          requests:\n            memory: "128Mi"\n            cpu: "100m"\n          limits:\n            memory: "256Mi"\n            cpu: "200m"\n        livenessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 10\n          periodSeconds: 10\n        readinessProbe:\n          httpGet:\n            path: /\n            port: 80\n          initialDelaySeconds: 5\n          periodSeconds: 5\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"k8s-services",children:"K8s Services"}),"\n",(0,r.jsx)(n.h3,{id:"backend-service",children:"Backend Service"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"apiVersion: v1\nkind: Service\nmetadata:\n  name: traffic-backend-service\n  namespace: traffic-system\n  labels:\n    app: traffic-backend\nspec:\n  type: ClusterIP\n  selector:\n    app: traffic-backend\n  ports:\n  - name: http\n    port: 8000\n    targetPort: 8000\n    protocol: TCP\n  sessionAffinity: ClientIP\n  sessionAffinityConfig:\n    clientIP:\n      timeoutSeconds: 10800\n"})}),"\n",(0,r.jsx)(n.h3,{id:"frontend-service",children:"Frontend Service"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"apiVersion: v1\nkind: Service\nmetadata:\n  name: traffic-frontend-service\n  namespace: traffic-system\nspec:\n  type: LoadBalancer\n  selector:\n    app: traffic-frontend\n  ports:\n  - port: 80\n    targetPort: 80\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"configmaps--secrets",children:"ConfigMaps & Secrets"}),"\n",(0,r.jsx)(n.h3,{id:"configmap",children:"ConfigMap"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'apiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: traffic-config\n  namespace: traffic-system\ndata:\n  log_level: "INFO"\n  fuseki_url: "http://fuseki-service:3030"\n  stellio_url: "http://stellio-service:8080"\n  kafka_bootstrap_servers: "kafka-service:9092"\n  app_config.yaml: |\n    server:\n      host: "0.0.0.0"\n      port: 8000\n    cache:\n      ttl: 300\n      max_size: 1000\n'})}),"\n",(0,r.jsx)(n.h3,{id:"secrets",children:"Secrets"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'apiVersion: v1\nkind: Secret\nmetadata:\n  name: postgres-secret\n  namespace: traffic-system\ntype: Opaque\nstringData:\n  url: "postgresql://traffic_user:ENCRYPTED_PASSWORD@postgres-service:5432/traffic_db"\n  username: "traffic_user"\n  password: "ENCRYPTED_PASSWORD"\n---\napiVersion: v1\nkind: Secret\nmetadata:\n  name: redis-secret\n  namespace: traffic-system\ntype: Opaque\nstringData:\n  url: "redis://:ENCRYPTED_PASSWORD@redis-service:6379/0"\n  password: "ENCRYPTED_PASSWORD"\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"ingress",children:"Ingress"}),"\n",(0,r.jsx)(n.h3,{id:"nginx-ingress-configuration",children:"NGINX Ingress Configuration"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'apiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: traffic-ingress\n  namespace: traffic-system\n  annotations:\n    cert-manager.io/cluster-issuer: "letsencrypt-prod"\n    nginx.ingress.kubernetes.io/ssl-redirect: "true"\n    nginx.ingress.kubernetes.io/rate-limit: "100"\n    nginx.ingress.kubernetes.io/cors-allow-origin: "*"\n    nginx.ingress.kubernetes.io/websocket-services: "traffic-backend-service"\nspec:\n  ingressClassName: nginx\n  tls:\n  - hosts:\n    - api.traffic.hcmc.gov.vn\n    - traffic.hcmc.gov.vn\n    secretName: traffic-tls-cert\n  rules:\n  - host: api.traffic.hcmc.gov.vn\n    http:\n      paths:\n      - path: /\n        pathType: Prefix\n        backend:\n          service:\n            name: traffic-backend-service\n            port:\n              number: 8000\n  - host: traffic.hcmc.gov.vn\n    http:\n      paths:\n      - path: /\n        pathType: Prefix\n        backend:\n          service:\n            name: traffic-frontend-service\n            port:\n              number: 80\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"statefulsets",children:"StatefulSets"}),"\n",(0,r.jsx)(n.h3,{id:"postgresql-statefulset",children:"PostgreSQL StatefulSet"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: postgres\n  namespace: traffic-system\nspec:\n  serviceName: postgres-service\n  replicas: 3\n  selector:\n    matchLabels:\n      app: postgres\n  template:\n    metadata:\n      labels:\n        app: postgres\n    spec:\n      containers:\n      - name: postgres\n        image: postgres:15-alpine\n        ports:\n        - containerPort: 5432\n          name: postgres\n        env:\n        - name: POSTGRES_DB\n          value: "traffic_db"\n        - name: POSTGRES_USER\n          valueFrom:\n            secretKeyRef:\n              name: postgres-secret\n              key: username\n        - name: POSTGRES_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: postgres-secret\n              key: password\n        - name: PGDATA\n          value: /var/lib/postgresql/data/pgdata\n        volumeMounts:\n        - name: postgres-storage\n          mountPath: /var/lib/postgresql/data\n        resources:\n          requests:\n            memory: "2Gi"\n            cpu: "1000m"\n          limits:\n            memory: "4Gi"\n            cpu: "2000m"\n        livenessProbe:\n          exec:\n            command:\n            - /bin/sh\n            - -c\n            - pg_isready -U traffic_user\n          initialDelaySeconds: 30\n          periodSeconds: 10\n  volumeClaimTemplates:\n  - metadata:\n      name: postgres-storage\n    spec:\n      accessModes: ["ReadWriteOnce"]\n      storageClassName: "fast-ssd"\n      resources:\n        requests:\n          storage: 100Gi\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h1,{id:"cicd-pipelines-1",children:"CI/CD Pipelines"}),"\n",(0,r.jsx)(n.h2,{id:"github-actions",children:"GitHub Actions"}),"\n",(0,r.jsx)(n.h3,{id:"complete-cicd-workflow",children:"Complete CI/CD Workflow"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"name: CI/CD Pipeline\n\non:\n  push:\n    branches: [main, develop]\n  pull_request:\n    branches: [main]\n\nenv:\n  REGISTRY: traffic.azurecr.io\n  IMAGE_NAME: traffic-backend\n\njobs:\n  test:\n    name: Run Tests\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n      \n      - name: Set up Python\n        uses: actions/setup-python@v4\n        with:\n          python-version: '3.9'\n      \n      - name: Cache dependencies\n        uses: actions/cache@v3\n        with:\n          path: ~/.cache/pip\n          key: ${{ runner.os }}-pip-${{ hashFiles('**/requirements.txt') }}\n      \n      - name: Install dependencies\n        run: |\n          pip install -r requirements/test.txt\n      \n      - name: Run unit tests\n        run: |\n          pytest tests/unit --cov=src --cov-report=xml\n      \n      - name: Run integration tests\n        run: |\n          docker-compose -f docker-compose.test.yml up -d\n          pytest tests/integration\n          docker-compose -f docker-compose.test.yml down\n      \n      - name: Upload coverage\n        uses: codecov/codecov-action@v3\n        with:\n          files: ./coverage.xml\n\n  security-scan:\n    name: Security Scanning\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n      \n      - name: Run Trivy vulnerability scanner\n        uses: aquasecurity/trivy-action@master\n        with:\n          scan-type: 'fs'\n          scan-ref: '.'\n          format: 'sarif'\n          output: 'trivy-results.sarif'\n      \n      - name: Upload Trivy results to GitHub Security\n        uses: github/codeql-action/upload-sarif@v2\n        with:\n          sarif_file: 'trivy-results.sarif'\n      \n      - name: Run Bandit security linter\n        run: |\n          pip install bandit\n          bandit -r src/ -f json -o bandit-report.json\n\n  build:\n    name: Build & Push Docker Images\n    runs-on: ubuntu-latest\n    needs: [test, security-scan]\n    if: github.event_name == 'push' && github.ref == 'refs/heads/main'\n    steps:\n      - uses: actions/checkout@v3\n      \n      - name: Set up Docker Buildx\n        uses: docker/setup-buildx-action@v2\n      \n      - name: Log in to Azure Container Registry\n        uses: docker/login-action@v2\n        with:\n          registry: ${{ env.REGISTRY }}\n          username: ${{ secrets.AZURE_CLIENT_ID }}\n          password: ${{ secrets.AZURE_CLIENT_SECRET }}\n      \n      - name: Extract metadata\n        id: meta\n        uses: docker/metadata-action@v4\n        with:\n          images: ${{ env.REGISTRY }}/${{ env.IMAGE_NAME }}\n          tags: |\n            type=ref,event=branch\n            type=ref,event=pr\n            type=semver,pattern={{version}}\n            type=sha\n      \n      - name: Build and push\n        uses: docker/build-push-action@v4\n        with:\n          context: .\n          push: true\n          tags: ${{ steps.meta.outputs.tags }}\n          labels: ${{ steps.meta.outputs.labels }}\n          cache-from: type=gha\n          cache-to: type=gha,mode=max\n\n  deploy:\n    name: Deploy to Kubernetes\n    runs-on: ubuntu-latest\n    needs: build\n    if: github.ref == 'refs/heads/main'\n    steps:\n      - uses: actions/checkout@v3\n      \n      - name: Set up kubectl\n        uses: azure/setup-kubectl@v3\n      \n      - name: Set up Helm\n        uses: azure/setup-helm@v3\n      \n      - name: Azure Login\n        uses: azure/login@v1\n        with:\n          creds: ${{ secrets.AZURE_CREDENTIALS }}\n      \n      - name: Get AKS credentials\n        run: |\n          az aks get-credentials --resource-group traffic-rg --name traffic-aks-cluster\n      \n      - name: Deploy with Helm\n        run: |\n          helm upgrade --install traffic-system ./helm/traffic-system \\\n            --namespace traffic-system \\\n            --create-namespace \\\n            --set image.tag=${{ github.sha }} \\\n            --set image.repository=${{ env.REGISTRY }}/${{ env.IMAGE_NAME }} \\\n            --wait --timeout 10m\n      \n      - name: Verify deployment\n        run: |\n          kubectl rollout status deployment/traffic-backend -n traffic-system\n          kubectl get pods -n traffic-system\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"monitoring--observability-1",children:"Monitoring & Observability"}),"\n",(0,r.jsx)(n.h3,{id:"prometheus-configuration",children:"Prometheus Configuration"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"global:\n  scrape_interval: 15s\n  evaluation_interval: 15s\n\nscrape_configs:\n  - job_name: 'kubernetes-pods'\n    kubernetes_sd_configs:\n      - role: pod\n    relabel_configs:\n      - source_labels: [__meta_kubernetes_pod_annotation_prometheus_io_scrape]\n        action: keep\n        regex: true\n      - source_labels: [__meta_kubernetes_pod_annotation_prometheus_io_path]\n        action: replace\n        target_label: __metrics_path__\n        regex: (.+)\n      - source_labels: [__address__, __meta_kubernetes_pod_annotation_prometheus_io_port]\n        action: replace\n        regex: ([^:]+)(?::\\d+)?;(\\d+)\n        replacement: $1:$2\n        target_label: __address__\n  \n  - job_name: 'traffic-backend'\n    static_configs:\n      - targets: ['traffic-backend-service:8000']\n  \n  - job_name: 'postgres'\n    static_configs:\n      - targets: ['postgres-exporter:9187']\n  \n  - job_name: 'redis'\n    static_configs:\n      - targets: ['redis-exporter:9121']\n"})}),"\n",(0,r.jsx)(n.h3,{id:"grafana-dashboard",children:"Grafana Dashboard"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "dashboard": {\n    "title": "Traffic System Metrics",\n    "panels": [\n      {\n        "title": "Request Rate",\n        "targets": [\n          {\n            "expr": "rate(http_requests_total[5m])"\n          }\n        ]\n      },\n      {\n        "title": "Response Time (P95)",\n        "targets": [\n          {\n            "expr": "histogram_quantile(0.95, rate(http_request_duration_seconds_bucket[5m]))"\n          }\n        ]\n      },\n      {\n        "title": "Error Rate",\n        "targets": [\n          {\n            "expr": "rate(http_requests_total{status=~\\"5..\\"}[5m])"\n          }\n        ]\n      },\n      {\n        "title": "Database Connections",\n        "targets": [\n          {\n            "expr": "pg_stat_database_numbackends"\n          }\n        ]\n      }\n    ]\n  }\n}\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"security-1",children:"Security"}),"\n",(0,r.jsx)(n.h3,{id:"rbac-configuration",children:"RBAC Configuration"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'apiVersion: v1\nkind: ServiceAccount\nmetadata:\n  name: traffic-backend-sa\n  namespace: traffic-system\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: Role\nmetadata:\n  name: traffic-backend-role\n  namespace: traffic-system\nrules:\n- apiGroups: [""]\n  resources: ["pods", "services", "configmaps"]\n  verbs: ["get", "list", "watch"]\n- apiGroups: ["apps"]\n  resources: ["deployments"]\n  verbs: ["get", "list"]\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: RoleBinding\nmetadata:\n  name: traffic-backend-rolebinding\n  namespace: traffic-system\nsubjects:\n- kind: ServiceAccount\n  name: traffic-backend-sa\n  namespace: traffic-system\nroleRef:\n  kind: Role\n  name: traffic-backend-role\n  apiGroup: rbac.authorization.k8s.io\n'})}),"\n",(0,r.jsx)(n.h3,{id:"network-policy",children:"Network Policy"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"apiVersion: networking.k8s.io/v1\nkind: NetworkPolicy\nmetadata:\n  name: traffic-backend-netpol\n  namespace: traffic-system\nspec:\n  podSelector:\n    matchLabels:\n      app: traffic-backend\n  policyTypes:\n  - Ingress\n  - Egress\n  ingress:\n  - from:\n    - podSelector:\n        matchLabels:\n          app: traffic-frontend\n    - namespaceSelector:\n        matchLabels:\n          name: ingress-nginx\n    ports:\n    - protocol: TCP\n      port: 8000\n  egress:\n  - to:\n    - podSelector:\n        matchLabels:\n          app: postgres\n    ports:\n    - protocol: TCP\n      port: 5432\n  - to:\n    - podSelector:\n        matchLabels:\n          app: redis\n    ports:\n    - protocol: TCP\n      port: 6379\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"scaling--performance-1",children:"Scaling & Performance"}),"\n",(0,r.jsx)(n.h3,{id:"horizontal-pod-autoscaler",children:"Horizontal Pod Autoscaler"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'apiVersion: autoscaling/v2\nkind: HorizontalPodAutoscaler\nmetadata:\n  name: traffic-backend-hpa\n  namespace: traffic-system\nspec:\n  scaleTargetRef:\n    apiVersion: apps/v1\n    kind: Deployment\n    name: traffic-backend\n  minReplicas: 3\n  maxReplicas: 10\n  metrics:\n  - type: Resource\n    resource:\n      name: cpu\n      target:\n        type: Utilization\n        averageUtilization: 70\n  - type: Resource\n    resource:\n      name: memory\n      target:\n        type: Utilization\n        averageUtilization: 80\n  - type: Pods\n    pods:\n      metric:\n        name: http_requests_per_second\n      target:\n        type: AverageValue\n        averageValue: "1000"\n  behavior:\n    scaleDown:\n      stabilizationWindowSeconds: 300\n      policies:\n      - type: Percent\n        value: 50\n        periodSeconds: 60\n    scaleUp:\n      stabilizationWindowSeconds: 0\n      policies:\n      - type: Percent\n        value: 100\n        periodSeconds: 30\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"backup--recovery-1",children:"Backup & Recovery"}),"\n",(0,r.jsx)(n.h3,{id:"postgresql-backup-cronjob",children:"PostgreSQL Backup CronJob"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'apiVersion: batch/v1\nkind: CronJob\nmetadata:\n  name: postgres-backup\n  namespace: traffic-system\nspec:\n  schedule: "0 2 * * *"  # Daily at 2 AM\n  jobTemplate:\n    spec:\n      template:\n        spec:\n          containers:\n          - name: backup\n            image: postgres:15-alpine\n            command:\n            - /bin/sh\n            - -c\n            - |\n              pg_dump -h postgres-service -U traffic_user -d traffic_db -F c -f /backup/backup-$(date +%Y%m%d-%H%M%S).dump\n              # Upload to Azure Blob Storage\n              az storage blob upload --account-name trafficstorage --container-name backups --file /backup/backup-*.dump\n            env:\n            - name: PGPASSWORD\n              valueFrom:\n                secretKeyRef:\n                  name: postgres-secret\n                  key: password\n            volumeMounts:\n            - name: backup\n              mountPath: /backup\n          volumes:\n          - name: backup\n            emptyDir: {}\n          restartPolicy: OnFailure\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"related-documentation",children:"Related Documentation"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/tes/vi/docs/agents/complete-agents-reference",children:"Complete Agents Reference"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/tes/vi/docs/api/complete-api-reference",children:"Complete API Reference"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/tes/vi/docs/testing/complete-testing-guide",children:"Complete Testing Guide"})}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"license",children:"License"}),"\n",(0,r.jsx)(n.p,{children:"MIT License - Copyright (c) 2025 UIP Contributors (Nguy\u1ec5n Nh\u1eadt Quang, Nguy\u1ec5n Vi\u1ec7t Ho\xe0ng, Nguy\u1ec5n \u0110\xecnh Anh Tu\u1ea5n)"}),"\n",(0,r.jsxs)(n.p,{children:["See ",(0,r.jsx)(n.a,{href:"../LICENSE",children:"LICENSE"})," for details."]})]})}function p(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>o});var t=s(6540);const r={},a=t.createContext(r);function i(e){const n=t.useContext(a);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),t.createElement(a.Provider,{value:n},e.children)}}}]);