"use strict";(globalThis.webpackChunkuip_urban_intelligence_platform_docs=globalThis.webpackChunkuip_urban_intelligence_platform_docs||[]).push([[5486],{8134:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>d,contentTitle:()=>c,default:()=>p,frontMatter:()=>o,metadata:()=>n,toc:()=>l});const n=JSON.parse('{"id":"frontend/services/citizenReportService","title":"Citizen Report Service","description":"API client for crowdsourced citizen report submissions","source":"@site/docs/frontend/services/citizenReportService.md","sourceDirName":"frontend/services","slug":"/frontend/services/citizenReportService","permalink":"/tes/docs/frontend/services/citizenReportService","draft":false,"unlisted":false,"editUrl":"https://github.com/NguyenNhatquang522004/UIP-Urban_Intelligence_Platform/tree/main/apps/traffic-web-app/frontend/docs/docs/frontend/services/citizenReportService.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2,"title":"Citizen Report Service","description":"API client for crowdsourced citizen report submissions"}}');var i=t(4848),s=t(8453);const o={sidebar_position:2,title:"Citizen Report Service",description:"API client for crowdsourced citizen report submissions"},c="Citizen Report Service",d={},l=[{value:"Overview",id:"overview",level:2},{value:"Configuration",id:"configuration",level:2},{value:"API Methods",id:"api-methods",level:2},{value:"submitReport",id:"submitreport",level:3},{value:"queryReports",id:"queryreports",level:3},{value:"getReportById",id:"getreportbyid",level:3},{value:"getStats",id:"getstats",level:3},{value:"Usage",id:"usage",level:2},{value:"Report Types",id:"report-types",level:2},{value:"Report Statuses",id:"report-statuses",level:2},{value:"NGSI-LD Integration",id:"ngsi-ld-integration",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"See Also",id:"see-also",level:2}];function a(e){const r={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:["\n",(0,i.jsx)(r.header,{children:(0,i.jsx)(r.h1,{id:"citizen-report-service",children:"Citizen Report Service"})}),"\n",(0,i.jsx)(r.p,{children:"Service class for communicating with the external Citizen Ingestion API (FastAPI :8001) for crowdsourced traffic reports."}),"\n",(0,i.jsx)(r.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsx)(r.p,{children:"The CitizenReportService handles all citizen-contributed data:"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:"Report submissions with photo uploads"}),"\n",(0,i.jsx)(r.li,{children:"Report retrieval with advanced filtering"}),"\n",(0,i.jsx)(r.li,{children:"Status updates (pending \u2192 verified/rejected)"}),"\n",(0,i.jsx)(r.li,{children:"Aggregated statistics"}),"\n",(0,i.jsx)(r.li,{children:"Direct integration with Stellio Context Broker"}),"\n"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-mermaid",children:'graph TD\r\n    A[CitizenReportService] --\x3e B[FastAPI :8001]\r\n    A --\x3e C[Stellio Context Broker]\r\n    \r\n    B --\x3e D[Submit Reports]\r\n    \r\n    C --\x3e E[Query Reports]\r\n    C --\x3e F[Get Report by ID]\r\n    C --\x3e G[Get Statistics]\r\n    \r\n    subgraph "Report Types"\r\n        H[traffic_jam]\r\n        I[accident]\r\n        J[flood]\r\n        K[road_damage]\r\n        L[other]\r\n    end\n'})}),"\n",(0,i.jsx)(r.h2,{id:"configuration",children:"Configuration"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-typescript",children:"// External Citizen Ingestion API (FastAPI :8001)\r\nconst CITIZEN_API_URL = import.meta.env.VITE_CITIZEN_API_URL || 'http://localhost:8001';\r\nconst STELLIO_URL = import.meta.env.VITE_STELLIO_URL || 'http://localhost:8080';\n"})}),"\n",(0,i.jsxs)(r.blockquote,{children:["\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.strong,{children:"Note"}),": This service targets the separate FastAPI ingestion service, NOT the main Express backend (:5001)."]}),"\n"]}),"\n",(0,i.jsx)(r.h2,{id:"api-methods",children:"API Methods"}),"\n",(0,i.jsx)(r.h3,{id:"submitreport",children:"submitReport"}),"\n",(0,i.jsx)(r.p,{children:"Submit a new citizen report to the external API."}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-typescript",children:"interface CitizenReportSubmission {\r\n    userId: string;\r\n    reportType: ReportType;\r\n    description?: string;\r\n    latitude: number;\r\n    longitude: number;\r\n    imageUrl: string;\r\n    timestamp?: string;\r\n}\r\n\r\nasync submitReport(submission: CitizenReportSubmission): Promise<{\r\n    status: 'accepted' | 'rejected';\r\n    message: string;\r\n    reportId: string;\r\n    processingStatus: string;\r\n}>\n"})}),"\n",(0,i.jsx)(r.h3,{id:"queryreports",children:"queryReports"}),"\n",(0,i.jsx)(r.p,{children:"Query citizen reports from Stellio Context Broker with optional filters."}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-typescript",children:"interface CitizenReportFilters {\r\n    reportType?: ReportType;\r\n    status?: ReportStatus;\r\n    aiVerified?: boolean;\r\n    minConfidence?: number;\r\n    hours?: number;\r\n    userId?: string;\r\n}\r\n\r\nasync queryReports(filters?: CitizenReportFilters): Promise<CitizenReport[]>\n"})}),"\n",(0,i.jsx)(r.h3,{id:"getreportbyid",children:"getReportById"}),"\n",(0,i.jsx)(r.p,{children:"Get a specific report by its ID from Stellio."}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-typescript",children:"async getReportById(reportId: string): Promise<CitizenReport | null>\n"})}),"\n",(0,i.jsx)(r.h3,{id:"getstats",children:"getStats"}),"\n",(0,i.jsx)(r.p,{children:"Get aggregated statistics about citizen reports."}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-typescript",children:"interface CitizenReportStats {\r\n    total: number;\r\n    byType: Record<ReportType, number>;\r\n    byStatus: Record<ReportStatus, number>;\r\n    verified: number;\r\n    unverified: number;\r\n    avgConfidence: number;\r\n    last24Hours: number;\r\n}\r\n\r\nasync getStats(): Promise<CitizenReportStats>\n"})}),"\n",(0,i.jsx)(r.h2,{id:"usage",children:"Usage"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-typescript",children:"import { CitizenReportService } from './services/citizenReportService';\r\n\r\n// Submit a new report\r\nconst result = await CitizenReportService.submitReport({\r\n    userId: 'user123',\r\n    reportType: 'accident',\r\n    description: 'Minor collision at intersection',\r\n    latitude: 10.762622,\r\n    longitude: 106.660172,\r\n    imageUrl: 'https://example.com/photo.jpg'\r\n});\r\n\r\n// Query verified accident reports\r\nconst accidents = await CitizenReportService.queryReports({\r\n    reportType: 'accident',\r\n    aiVerified: true,\r\n    minConfidence: 0.8\r\n});\r\n\r\n// Get statistics\r\nconst stats = await CitizenReportService.getStats();\r\nconsole.log(`${stats.total} total reports, ${stats.verified} verified`);\n"})}),"\n",(0,i.jsx)(r.h2,{id:"report-types",children:"Report Types"}),"\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{children:"Type"}),(0,i.jsx)(r.th,{children:"Description"})]})}),(0,i.jsxs)(r.tbody,{children:[(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"traffic_jam"})}),(0,i.jsx)(r.td,{children:"Traffic congestion report"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"accident"})}),(0,i.jsx)(r.td,{children:"Road accident or collision"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"flood"})}),(0,i.jsx)(r.td,{children:"Flooding on road"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"road_damage"})}),(0,i.jsx)(r.td,{children:"Pothole or road damage"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"other"})}),(0,i.jsx)(r.td,{children:"Other traffic-related issue"})]})]})]}),"\n",(0,i.jsx)(r.h2,{id:"report-statuses",children:"Report Statuses"}),"\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{children:"Status"}),(0,i.jsx)(r.th,{children:"Description"})]})}),(0,i.jsxs)(r.tbody,{children:[(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"pending_verification"})}),(0,i.jsx)(r.td,{children:"Awaiting AI verification"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"verified"})}),(0,i.jsx)(r.td,{children:"Confirmed by AI system"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"rejected"})}),(0,i.jsx)(r.td,{children:"Rejected as invalid"})]})]})]}),"\n",(0,i.jsx)(r.h2,{id:"ngsi-ld-integration",children:"NGSI-LD Integration"}),"\n",(0,i.jsxs)(r.p,{children:["Reports are stored as ",(0,i.jsx)(r.code,{children:"CitizenObservation"})," entities in Stellio:"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-json",children:'{\r\n    "id": "urn:ngsi-ld:CitizenObservation:abc123",\r\n    "type": "CitizenObservation",\r\n    "category": { "value": "accident" },\r\n    "description": { "value": "Minor collision" },\r\n    "location": {\r\n        "value": {\r\n            "type": "Point",\r\n            "coordinates": [106.660172, 10.762622]\r\n        }\r\n    },\r\n    "aiVerified": { "value": true },\r\n    "aiConfidence": { "value": 0.92 },\r\n    "reportedBy": { "object": "urn:ngsi-ld:User:user123" }\r\n}\n'})}),"\n",(0,i.jsx)(r.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"axios@^1.4"}),": HTTP client with multipart support"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"citizenReport"})," types: TypeScript interfaces"]}),"\n"]}),"\n",(0,i.jsx)(r.h2,{id:"see-also",children:"See Also"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:(0,i.jsx)(r.a,{href:"/tes/docs/frontend/types/citizenReport",children:"Citizen Report Types"})}),"\n",(0,i.jsx)(r.li,{children:(0,i.jsx)(r.a,{href:"/tes/docs/frontend/components/CitizenReportForm",children:"CitizenReportForm Component"})}),"\n",(0,i.jsx)(r.li,{children:(0,i.jsx)(r.a,{href:"/tes/docs/frontend/components/CitizenReportMarkers",children:"CitizenReportMarkers Component"})}),"\n"]})]})}function p(e={}){const{wrapper:r}={...(0,s.R)(),...e.components};return r?(0,i.jsx)(r,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},8453:(e,r,t)=>{t.d(r,{R:()=>o,x:()=>c});var n=t(6540);const i={},s=n.createContext(i);function o(e){const r=n.useContext(s);return n.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function c(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),n.createElement(s.Provider,{value:r},e.children)}}}]);