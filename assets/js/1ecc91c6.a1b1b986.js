"use strict";(globalThis.webpackChunkuip_urban_intelligence_platform_docs=globalThis.webpackChunkuip_urban_intelligence_platform_docs||[]).push([[7966],{6603:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"agents/notification/alert-dispatcher","title":"alert-dispatcher","description":"\x3c!--","source":"@site/docs/agents/notification/alert-dispatcher.md","sourceDirName":"agents/notification","slug":"/agents/notification/alert-dispatcher","permalink":"/tes/docs/agents/notification/alert-dispatcher","draft":false,"unlisted":false,"editUrl":"https://github.com/NguyenNhatquang522004/UIP-Urban_Intelligence_Platform/tree/main/apps/traffic-web-app/frontend/docs/docs/agents/notification/alert-dispatcher.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"api-gateway","permalink":"/tes/docs/agents/integration/api-gateway"},"next":{"title":"email-notification-handler","permalink":"/tes/docs/agents/notification/email-notification-handler"}}');var r=t(4848),s=t(8453);const a={},l="Alert Dispatcher Agent",c={},o=[{value:"Overview",id:"overview",level:2},{value:"Features",id:"features",level:2},{value:"Architecture",id:"architecture",level:2},{value:"Configuration",id:"configuration",level:2},{value:"Usage",id:"usage",level:2},{value:"Basic Alert Dispatch",id:"basic-alert-dispatch",level:3},{value:"Targeted User Alerts",id:"targeted-user-alerts",level:3},{value:"Webhook Dispatch",id:"webhook-dispatch",level:3},{value:"Broadcast Alert",id:"broadcast-alert",level:3},{value:"API Reference",id:"api-reference",level:2},{value:"Class: <code>AlertDispatcherAgent</code>",id:"class-alertdispatcheragent",level:3},{value:"Methods",id:"methods",level:4},{value:"<code>dispatch_alert(alert_type: str, priority: str, location: dict, channels: List[str], **kwargs) -&gt; str</code>",id:"dispatch_alertalert_type-str-priority-str-location-dict-channels-liststr-kwargs---str",level:5},{value:"<code>dispatch_to_users(user_ids: List[str], alert_type: str, priority: str, **kwargs)</code>",id:"dispatch_to_usersuser_ids-liststr-alert_type-str-priority-str-kwargs",level:5},{value:"<code>dispatch_webhook(webhook_url: str, payload: dict, headers: dict = None) -&gt; WebhookResult</code>",id:"dispatch_webhookwebhook_url-str-payload-dict-headers-dict--none---webhookresult",level:5},{value:"<code>broadcast_alert(alert_type: str, priority: str, radius_km: float, center_location: dict, message: str, channels: List[str])</code>",id:"broadcast_alertalert_type-str-priority-str-radius_km-float-center_location-dict-message-str-channels-liststr",level:5},{value:"<code>get_alert_status(alert_id: str) -&gt; AlertStatus</code>",id:"get_alert_statusalert_id-str---alertstatus",level:5},{value:"Data Models",id:"data-models",level:3},{value:"<code>AlertStatus</code>",id:"alertstatus",level:4},{value:"<code>WebhookResult</code>",id:"webhookresult",level:4},{value:"Alert Types",id:"alert-types",level:2},{value:"1. Accident Alerts",id:"1-accident-alerts",level:3},{value:"2. Congestion Alerts",id:"2-congestion-alerts",level:3},{value:"3. Weather Alerts",id:"3-weather-alerts",level:3},{value:"4. Citizen Report Alerts",id:"4-citizen-report-alerts",level:3},{value:"Template System",id:"template-system",level:2},{value:"Email Template Example",id:"email-template-example",level:3},{value:"SMS Template Example",id:"sms-template-example",level:3},{value:"Integration Examples",id:"integration-examples",level:2},{value:"Integration with Accident Detection",id:"integration-with-accident-detection",level:3},{value:"Integration with Subscription Manager",id:"integration-with-subscription-manager",level:3},{value:"Integration with Incident Report Generator",id:"integration-with-incident-report-generator",level:3},{value:"Monitoring &amp; Metrics",id:"monitoring--metrics",level:2},{value:"Health Check",id:"health-check",level:3},{value:"Channel Performance",id:"channel-performance",level:3},{value:"Performance Optimization",id:"performance-optimization",level:2},{value:"Async Dispatch",id:"async-dispatch",level:3},{value:"Batch Dispatch",id:"batch-dispatch",level:3},{value:"Queue Optimization",id:"queue-optimization",level:3},{value:"Testing",id:"testing",level:2},{value:"Unit Tests",id:"unit-tests",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"1. Priority-Based Routing",id:"1-priority-based-routing",level:3},{value:"2. Prevent Alert Fatigue",id:"2-prevent-alert-fatigue",level:3},{value:"3. Delivery Confirmation",id:"3-delivery-confirmation",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Issue: High Failure Rate",id:"issue-high-failure-rate",level:3},{value:"Issue: Slow Delivery",id:"issue-slow-delivery",level:3},{value:"Issue: Duplicate Alerts",id:"issue-duplicate-alerts",level:3},{value:"Related Documentation",id:"related-documentation",level:2},{value:"License",id:"license",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"alert-dispatcher-agent",children:"Alert Dispatcher Agent"})}),"\n",(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsx)(n.p,{children:"The Alert Dispatcher Agent is a critical component of the traffic management system, responsible for real-time distribution of traffic alerts, accidents, congestion warnings, and citizen reports to multiple channels including email, SMS, push notifications, and webhooks."}),"\n",(0,r.jsx)(n.h2,{id:"features",children:"Features"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Multi-Channel Dispatch"}),": Email, SMS, push notifications, webhooks, WebSocket"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Priority Routing"}),": Critical alerts bypass queuing for immediate delivery"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Template Engine"}),": Customizable alert templates with dynamic content"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Subscription Management"}),": User preferences and channel subscriptions"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Rate Limiting"}),": Prevent alert fatigue with intelligent throttling"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Delivery Tracking"}),": Monitor alert delivery status and failures"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Retry Mechanism"}),": Automatic retry for failed deliveries"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"architecture",children:"Architecture"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-mermaid",children:"graph TB\n    A[Alert Source] --\x3e B[Alert Dispatcher]\n    B --\x3e C{Priority Level}\n    C --\x3e|Critical| D[Immediate Queue]\n    C --\x3e|High/Medium/Low| E[Standard Queue]\n    D --\x3e F[Channel Router]\n    E --\x3e F\n    F --\x3e G{Channel Type}\n    G --\x3e|Email| H[Email Service]\n    G --\x3e|SMS| I[SMS Service]\n    G --\x3e|Push| J[Push Service]\n    G --\x3e|Webhook| K[Webhook Service]\n    G --\x3e|WebSocket| L[WebSocket Service]\n    H --\x3e M[Delivery Tracker]\n    I --\x3e M\n    J --\x3e M\n    K --\x3e M\n    L --\x3e M\n    M --\x3e N[MongoDB Logs]\n"})}),"\n",(0,r.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"File"}),": ",(0,r.jsx)(n.code,{children:"config/alert_dispatcher_config.yaml"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'alert_dispatcher:\n  channels:\n    email:\n      enabled: true\n      provider: "smtp"\n      smtp_host: "${SMTP_HOST}"\n      smtp_port: 587\n      from_address: "alerts@hcmc-traffic.vn"\n      \n    sms:\n      enabled: true\n      provider: "twilio"\n      account_sid: "${TWILIO_ACCOUNT_SID}"\n      auth_token: "${TWILIO_AUTH_TOKEN}"\n      from_number: "+84123456789"\n      \n    push:\n      enabled: true\n      provider: "firebase"\n      project_id: "${FIREBASE_PROJECT_ID}"\n      \n    webhook:\n      enabled: true\n      timeout: 10\n      retry_attempts: 3\n      \n    websocket:\n      enabled: true\n      server_url: "ws://localhost:8765"\n      \n  priority_levels:\n    critical:\n      max_queue_time: 0          # Immediate dispatch\n      retry_attempts: 5\n      retry_delay: 10             # seconds\n      \n    high:\n      max_queue_time: 30          # seconds\n      retry_attempts: 3\n      retry_delay: 30\n      \n    medium:\n      max_queue_time: 120\n      retry_attempts: 2\n      retry_delay: 60\n      \n    low:\n      max_queue_time: 300\n      retry_attempts: 1\n      retry_delay: 120\n      \n  rate_limiting:\n    enabled: true\n    max_alerts_per_user_hour: 10\n    max_alerts_per_user_day: 50\n    cooldown_period: 300          # 5 minutes for same alert type\n    \n  templates:\n    accident_critical:\n      subject: "\ud83d\udea8 Critical Accident Alert: {location}"\n      body: "accident_critical.html"\n      \n    congestion_heavy:\n      subject: "\u26a0\ufe0f Heavy Traffic Alert: {location}"\n      body: "congestion_heavy.html"\n      \n    citizen_report_verified:\n      subject: "\u2705 Your Report Has Been Verified"\n      body: "citizen_verified.html"\n'})}),"\n",(0,r.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,r.jsx)(n.h3,{id:"basic-alert-dispatch",children:"Basic Alert Dispatch"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'from src.agents.notification.alert_dispatcher_agent import AlertDispatcherAgent\n\n# Initialize agent\nagent = AlertDispatcherAgent()\n\n# Dispatch critical accident alert\nalert_id = agent.dispatch_alert(\n    alert_type="accident_critical",\n    priority="critical",\n    location={"lat": 10.7769, "lon": 106.7009, "address": "Nguyen Hue Blvd"},\n    severity="high",\n    description="Multi-vehicle collision blocking 3 lanes",\n    image_url="https://cdn.example.com/accident_001.jpg",\n    channels=["email", "sms", "push", "webhook"]\n)\n\nprint(f"Alert dispatched: {alert_id}")\n'})}),"\n",(0,r.jsx)(n.h3,{id:"targeted-user-alerts",children:"Targeted User Alerts"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'# Send alert to specific users\nagent.dispatch_to_users(\n    user_ids=["user_123", "user_456", "user_789"],\n    alert_type="congestion_heavy",\n    priority="high",\n    location={"address": "District 1 Center"},\n    message="Heavy congestion detected in your area"\n)\n'})}),"\n",(0,r.jsx)(n.h3,{id:"webhook-dispatch",children:"Webhook Dispatch"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'# Send alert to external webhook\nagent.dispatch_webhook(\n    webhook_url="https://external-system.com/api/alerts",\n    payload={\n        "event": "accident_detected",\n        "severity": "high",\n        "location": {"lat": 10.7769, "lon": 106.7009},\n        "timestamp": "2024-01-15T10:30:00Z"\n    },\n    headers={"X-API-Key": "your-api-key"}\n)\n'})}),"\n",(0,r.jsx)(n.h3,{id:"broadcast-alert",children:"Broadcast Alert"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'# Broadcast to all subscribed users in area\nagent.broadcast_alert(\n    alert_type="weather_warning",\n    priority="high",\n    radius_km=5,\n    center_location={"lat": 10.7769, "lon": 106.7009},\n    message="Heavy rain expected in next 30 minutes",\n    channels=["push", "websocket"]\n)\n'})}),"\n",(0,r.jsx)(n.h2,{id:"api-reference",children:"API Reference"}),"\n",(0,r.jsxs)(n.h3,{id:"class-alertdispatcheragent",children:["Class: ",(0,r.jsx)(n.code,{children:"AlertDispatcherAgent"})]}),"\n",(0,r.jsx)(n.h4,{id:"methods",children:"Methods"}),"\n",(0,r.jsx)(n.h5,{id:"dispatch_alertalert_type-str-priority-str-location-dict-channels-liststr-kwargs---str",children:(0,r.jsx)(n.code,{children:"dispatch_alert(alert_type: str, priority: str, location: dict, channels: List[str], **kwargs) -> str"})}),"\n",(0,r.jsx)(n.p,{children:"Dispatch alert to multiple channels."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"alert_type"})," (str): Type of alert (accident, congestion, weather, etc.)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"priority"})," (str): Priority level (critical, high, medium, low)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"location"})," (dict): Location information"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"channels"})," (List[str]): Target channels"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"**kwargs"}),": Additional alert data"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Returns:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"str: Alert ID"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'alert_id = agent.dispatch_alert(\n    alert_type="accident_critical",\n    priority="critical",\n    location={"lat": 10.7769, "lon": 106.7009},\n    channels=["email", "sms", "push"]\n)\n'})}),"\n",(0,r.jsx)(n.h5,{id:"dispatch_to_usersuser_ids-liststr-alert_type-str-priority-str-kwargs",children:(0,r.jsx)(n.code,{children:"dispatch_to_users(user_ids: List[str], alert_type: str, priority: str, **kwargs)"})}),"\n",(0,r.jsx)(n.p,{children:"Send alert to specific users."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"user_ids"})," (List[str]): List of user IDs"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"alert_type"})," (str): Alert type"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"priority"})," (str): Priority level"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"**kwargs"}),": Alert content"]}),"\n"]}),"\n",(0,r.jsx)(n.h5,{id:"dispatch_webhookwebhook_url-str-payload-dict-headers-dict--none---webhookresult",children:(0,r.jsx)(n.code,{children:"dispatch_webhook(webhook_url: str, payload: dict, headers: dict = None) -> WebhookResult"})}),"\n",(0,r.jsx)(n.p,{children:"Send alert to external webhook."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"webhook_url"})," (str): Webhook endpoint URL"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"payload"})," (dict): Alert payload"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"headers"})," (dict, optional): HTTP headers"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Returns:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"WebhookResult: Delivery result"}),"\n"]}),"\n",(0,r.jsx)(n.h5,{id:"broadcast_alertalert_type-str-priority-str-radius_km-float-center_location-dict-message-str-channels-liststr",children:(0,r.jsx)(n.code,{children:"broadcast_alert(alert_type: str, priority: str, radius_km: float, center_location: dict, message: str, channels: List[str])"})}),"\n",(0,r.jsx)(n.p,{children:"Broadcast alert to users in geographic area."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"alert_type"})," (str): Alert type"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"priority"})," (str): Priority level"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"radius_km"})," (float): Broadcast radius"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"center_location"})," (dict): Center coordinates"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"message"})," (str): Alert message"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"channels"})," (List[str]): Delivery channels"]}),"\n"]}),"\n",(0,r.jsx)(n.h5,{id:"get_alert_statusalert_id-str---alertstatus",children:(0,r.jsx)(n.code,{children:"get_alert_status(alert_id: str) -> AlertStatus"})}),"\n",(0,r.jsx)(n.p,{children:"Get delivery status of alert."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"alert_id"})," (str): Alert identifier"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Returns:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"AlertStatus: Delivery status and statistics"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'status = agent.get_alert_status(alert_id)\nprint(f"Delivered: {status.delivered_count}/{status.total_recipients}")\nprint(f"Failed: {status.failed_count}")\n'})}),"\n",(0,r.jsx)(n.h3,{id:"data-models",children:"Data Models"}),"\n",(0,r.jsx)(n.h4,{id:"alertstatus",children:(0,r.jsx)(n.code,{children:"AlertStatus"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"@dataclass\nclass AlertStatus:\n    alert_id: str\n    alert_type: str\n    priority: str\n    dispatched_at: datetime\n    total_recipients: int\n    delivered_count: int\n    failed_count: int\n    pending_count: int\n    delivery_channels: dict        # {channel: count}\n    retry_attempts: int\n    final_status: str              # delivered, partial, failed\n"})}),"\n",(0,r.jsx)(n.h4,{id:"webhookresult",children:(0,r.jsx)(n.code,{children:"WebhookResult"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"@dataclass\nclass WebhookResult:\n    success: bool\n    status_code: int\n    response_body: str\n    delivery_time_ms: int\n    error_message: str\n"})}),"\n",(0,r.jsx)(n.h2,{id:"alert-types",children:"Alert Types"}),"\n",(0,r.jsx)(n.h3,{id:"1-accident-alerts",children:"1. Accident Alerts"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'agent.dispatch_alert(\n    alert_type="accident_critical",\n    priority="critical",\n    location={"lat": 10.7769, "lon": 106.7009},\n    severity="high",\n    vehicles_involved=3,\n    lane_blockage="full",\n    estimated_clearance="30 minutes"\n)\n'})}),"\n",(0,r.jsx)(n.h3,{id:"2-congestion-alerts",children:"2. Congestion Alerts"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'agent.dispatch_alert(\n    alert_type="congestion_heavy",\n    priority="high",\n    location={"address": "District 1"},\n    congestion_level="heavy",\n    delay_minutes=20,\n    alternate_routes=["Route A", "Route B"]\n)\n'})}),"\n",(0,r.jsx)(n.h3,{id:"3-weather-alerts",children:"3. Weather Alerts"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'agent.dispatch_alert(\n    alert_type="weather_warning",\n    priority="high",\n    location={"address": "HCMC"},\n    condition="heavy_rain",\n    duration="2 hours",\n    safety_recommendations=["Drive slowly", "Turn on lights"]\n)\n'})}),"\n",(0,r.jsx)(n.h3,{id:"4-citizen-report-alerts",children:"4. Citizen Report Alerts"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'agent.dispatch_alert(\n    alert_type="citizen_report_verified",\n    priority="medium",\n    user_id="user_123",\n    report_id="CR_001",\n    status="verified",\n    action_taken="Traffic police dispatched"\n)\n'})}),"\n",(0,r.jsx)(n.h2,{id:"template-system",children:"Template System"}),"\n",(0,r.jsx)(n.h3,{id:"email-template-example",children:"Email Template Example"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"File"}),": ",(0,r.jsx)(n.code,{children:"templates/accident_critical.html"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-html",children:'<!DOCTYPE html>\n<html>\n<head>\n    <title>Critical Accident Alert</title>\n</head>\n<body>\n    <h1>\ud83d\udea8 Critical Accident Alert</h1>\n    <p><strong>Location:</strong> {{ location.address }}</p>\n    <p><strong>Severity:</strong> {{ severity }}</p>\n    <p><strong>Description:</strong> {{ description }}</p>\n    <p><strong>Time:</strong> {{ timestamp }}</p>\n    \n    {% if image_url %}\n    <img src="{{ image_url }}" alt="Accident Image" width="400">\n    {% endif %}\n    \n    <p><strong>Recommended Actions:</strong></p>\n    <ul>\n        {% for action in recommended_actions %}\n        <li>{{ action }}</li>\n        {% endfor %}\n    </ul>\n</body>\n</html>\n'})}),"\n",(0,r.jsx)(n.h3,{id:"sms-template-example",children:"SMS Template Example"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'# SMS template (160 characters max)\n"{alert_type}: {location.address}. {severity} severity. Avoid area. ETA clearance: {clearance_time}."\n'})}),"\n",(0,r.jsx)(n.h2,{id:"integration-examples",children:"Integration Examples"}),"\n",(0,r.jsx)(n.h3,{id:"integration-with-accident-detection",children:"Integration with Accident Detection"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'from src.agents.analytics.accident_detection_agent import AccidentDetectionAgent\n\naccident_agent = AccidentDetectionAgent()\nalert_agent = AlertDispatcherAgent()\n\ndef handle_accident_detection(detection_result):\n    if detection_result.severity in ["severe", "critical"]:\n        # Dispatch immediate alert\n        alert_agent.dispatch_alert(\n            alert_type="accident_critical",\n            priority="critical",\n            location=detection_result.location,\n            severity=detection_result.severity,\n            image_url=detection_result.image_path,\n            channels=["email", "sms", "push", "webhook"]\n        )\n'})}),"\n",(0,r.jsx)(n.h3,{id:"integration-with-subscription-manager",children:"Integration with Subscription Manager"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'from src.agents.notification.subscription_manager_agent import SubscriptionManagerAgent\n\nsubscription_agent = SubscriptionManagerAgent()\n\n# Get subscribed users for alert type\nsubscribed_users = subscription_agent.get_subscribed_users(\n    alert_type="congestion_heavy",\n    location={"lat": 10.7769, "lon": 106.7009},\n    radius_km=2\n)\n\n# Dispatch to subscribed users only\nalert_agent.dispatch_to_users(\n    user_ids=[u.user_id for u in subscribed_users],\n    alert_type="congestion_heavy",\n    priority="high",\n    location={"address": "District 1"}\n)\n'})}),"\n",(0,r.jsx)(n.h3,{id:"integration-with-incident-report-generator",children:"Integration with Incident Report Generator"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'from src.agents.notification.incident_report_generator_agent import IncidentReportGeneratorAgent\n\nreport_agent = IncidentReportGeneratorAgent()\n\n# Generate incident report\nincident_report = report_agent.generate_report(\n    incident_id="INC_001",\n    include_images=True,\n    include_timeline=True\n)\n\n# Dispatch report to authorities\nalert_agent.dispatch_alert(\n    alert_type="incident_report",\n    priority="high",\n    recipients=["traffic.police@hcmc.gov.vn"],\n    channels=["email"],\n    report_pdf=incident_report.pdf_url\n)\n'})}),"\n",(0,r.jsx)(n.h2,{id:"monitoring--metrics",children:"Monitoring & Metrics"}),"\n",(0,r.jsx)(n.h3,{id:"health-check",children:"Health Check"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'health = agent.health_check()\nprint(f"Status: {health.status}")\nprint(f"Alerts Dispatched Today: {health.alerts_today}")\nprint(f"Delivery Success Rate: {health.delivery_success_rate}%")\nprint(f"Active Channels: {health.active_channels}")\nprint(f"Queue Size: {health.queue_size}")\n'})}),"\n",(0,r.jsx)(n.h3,{id:"channel-performance",children:"Channel Performance"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'metrics = agent.get_channel_metrics(time_range="24h")\n\nfor channel, stats in metrics.items():\n    print(f"{channel}:")\n    print(f"  Success Rate: {stats.success_rate}%")\n    print(f"  Avg Delivery Time: {stats.avg_delivery_time}ms")\n    print(f"  Failed: {stats.failed_count}")\n'})}),"\n",(0,r.jsx)(n.h2,{id:"performance-optimization",children:"Performance Optimization"}),"\n",(0,r.jsx)(n.h3,{id:"async-dispatch",children:"Async Dispatch"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'# Dispatch alerts asynchronously\nawait agent.dispatch_alert_async(\n    alert_type="congestion_heavy",\n    priority="high",\n    location={"address": "District 1"},\n    channels=["email", "sms", "push"]\n)\n'})}),"\n",(0,r.jsx)(n.h3,{id:"batch-dispatch",children:"Batch Dispatch"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'# Dispatch multiple alerts in batch\nalerts = [\n    {"alert_type": "congestion_heavy", "location": {...}},\n    {"alert_type": "accident_minor", "location": {...}},\n]\n\nagent.batch_dispatch(alerts, parallel=True)\n'})}),"\n",(0,r.jsx)(n.h3,{id:"queue-optimization",children:"Queue Optimization"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# Configure queue settings\nagent.configure_queue(\n    max_queue_size=1000,\n    worker_threads=10,\n    batch_size=50\n)\n"})}),"\n",(0,r.jsx)(n.h2,{id:"testing",children:"Testing"}),"\n",(0,r.jsx)(n.h3,{id:"unit-tests",children:"Unit Tests"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'import pytest\n\ndef test_alert_dispatch():\n    agent = AlertDispatcherAgent()\n    \n    alert_id = agent.dispatch_alert(\n        alert_type="test_alert",\n        priority="low",\n        location={"lat": 10.7769, "lon": 106.7009},\n        channels=["email"]\n    )\n    \n    assert alert_id is not None\n    \n    status = agent.get_alert_status(alert_id)\n    assert status.final_status in ["delivered", "pending"]\n\ndef test_rate_limiting():\n    agent = AlertDispatcherAgent()\n    \n    # Send multiple alerts\n    for i in range(15):\n        agent.dispatch_alert(\n            alert_type="test_alert",\n            priority="low",\n            location={},\n            channels=["email"],\n            user_id="test_user"\n        )\n    \n    # Should trigger rate limit\n    stats = agent.get_user_stats("test_user")\n    assert stats.rate_limited == True\n'})}),"\n",(0,r.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,r.jsx)(n.h3,{id:"1-priority-based-routing",children:"1. Priority-Based Routing"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'# Critical alerts bypass queue\nif severity == "critical":\n    priority = "critical"\nelse:\n    priority = "high" if urgency > 0.7 else "medium"\n'})}),"\n",(0,r.jsx)(n.h3,{id:"2-prevent-alert-fatigue",children:"2. Prevent Alert Fatigue"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"agent.configure_rate_limiting(\n    max_alerts_per_user_hour=10,\n    cooldown_period=300  # 5 minutes\n)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"3-delivery-confirmation",children:"3. Delivery Confirmation"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"status = agent.get_alert_status(alert_id)\nif status.failed_count > 0:\n    agent.retry_failed_deliveries(alert_id)\n"})}),"\n",(0,r.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,r.jsx)(n.h3,{id:"issue-high-failure-rate",children:"Issue: High Failure Rate"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution"}),": Check channel configurations and retry settings"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"agent.test_channels()  # Test all channel connections\nagent.configure_retry(attempts=5, delay=30)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"issue-slow-delivery",children:"Issue: Slow Delivery"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution"}),": Increase worker threads and enable async"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"agent.configure_queue(worker_threads=20)\nagent.enable_async_dispatch()\n"})}),"\n",(0,r.jsx)(n.h3,{id:"issue-duplicate-alerts",children:"Issue: Duplicate Alerts"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution"}),": Enable deduplication"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'agent.enable_deduplication(\n    time_window=300,  # 5 minutes\n    key_fields=["alert_type", "location", "user_id"]\n)\n'})}),"\n",(0,r.jsx)(n.h2,{id:"related-documentation",children:"Related Documentation"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/tes/docs/agents/notification/subscription-manager",children:"Subscription Manager Agent"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/tes/docs/agents/notification/email-notification-handler",children:"Email Notification Handler"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/tes/docs/agents/notification/webhook-notification-handler",children:"Webhook Notification Handler"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/tes/docs/agents/notification/incident-report-generator",children:"Incident Report Generator"})}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"license",children:"License"}),"\n",(0,r.jsx)(n.p,{children:"MIT License - Copyright (c) 2025 UIP Contributors (Nguy\u1ec5n Nh\u1eadt Quang, Nguy\u1ec5n Vi\u1ec7t Ho\xe0ng, Nguy\u1ec5n \u0110\xecnh Anh Tu\u1ea5n)"}),"\n",(0,r.jsxs)(n.p,{children:["See ",(0,r.jsx)(n.a,{href:"../LICENSE",children:"LICENSE"})," for details."]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>l});var i=t(6540);const r={},s=i.createContext(r);function a(e){const n=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);