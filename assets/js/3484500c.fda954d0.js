"use strict";(globalThis.webpackChunkuip_urban_intelligence_platform_docs=globalThis.webpackChunkuip_urban_intelligence_platform_docs||[]).push([[8266],{7843:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>s,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"frontend/store/trafficStore","title":"Traffic Store","description":"Centralized Zustand state management for the traffic application","source":"@site/docs/frontend/store/trafficStore.md","sourceDirName":"frontend/store","slug":"/frontend/store/trafficStore","permalink":"/tes/docs/frontend/store/trafficStore","draft":false,"unlisted":false,"editUrl":"https://github.com/NguyenNhatquang522004/UIP-Urban_Intelligence_Platform/tree/main/apps/traffic-web-app/frontend/docs/docs/frontend/store/trafficStore.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"Traffic Store","description":"Centralized Zustand state management for the traffic application"}}');var a=n(4848),i=n(8453);const s={sidebar_position:1,title:"Traffic Store",description:"Centralized Zustand state management for the traffic application"},l="Traffic Store",o={},c=[{value:"Overview",id:"overview",level:2},{value:"State Categories",id:"state-categories",level:2},{value:"Entity Data",id:"entity-data",level:3},{value:"Derived Data",id:"derived-data",level:3},{value:"UI State",id:"ui-state",level:3},{value:"Filter State",id:"filter-state",level:2},{value:"Actions",id:"actions",level:2},{value:"Data Management",id:"data-management",level:3},{value:"Data Loading",id:"data-loading",level:3},{value:"Filter Actions",id:"filter-actions",level:3},{value:"Computed Values",id:"computed-values",level:3},{value:"Usage",id:"usage",level:2},{value:"Persistence",id:"persistence",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Best Practices",id:"best-practices",level:2},{value:"See Also",id:"see-also",level:2}];function d(e){const r={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:["\n",(0,a.jsx)(r.header,{children:(0,a.jsx)(r.h1,{id:"traffic-store",children:"Traffic Store"})}),"\n",(0,a.jsx)(r.p,{children:"Centralized state management for the traffic application using Zustand with persistence."}),"\n",(0,a.jsx)(r.h2,{id:"overview",children:"Overview"}),"\n",(0,a.jsx)(r.p,{children:"The Traffic Store manages all application state:"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsx)(r.li,{children:"Entity data (cameras, weather, air quality, accidents, patterns)"}),"\n",(0,a.jsx)(r.li,{children:"Derived data (pollutants, heatmaps, zones)"}),"\n",(0,a.jsx)(r.li,{children:"UI state (layer visibility, filters)"}),"\n",(0,a.jsx)(r.li,{children:"Loading and error states"}),"\n",(0,a.jsx)(r.li,{children:"Persistence to localStorage"}),"\n"]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-mermaid",children:"graph TD\r\n    A[Traffic Store] --\x3e B[Entity Data]\r\n    A --\x3e C[Derived Data]\r\n    A --\x3e D[UI State]\r\n    A --\x3e E[Actions]\r\n    \r\n    B --\x3e F[cameras]\r\n    B --\x3e G[weather]\r\n    B --\x3e H[airQuality]\r\n    B --\x3e I[accidents]\r\n    B --\x3e J[patterns]\r\n    \r\n    C --\x3e K[pollutants]\r\n    C --\x3e L[humidityZones]\r\n    C --\x3e M[vehicleHeatmap]\r\n    C --\x3e N[speedZones]\r\n    \r\n    D --\x3e O[filters]\r\n    D --\x3e P[loading]\r\n    D --\x3e Q[error]\r\n    D --\x3e R[isConnected]\r\n    \r\n    E --\x3e S[Data Setters]\r\n    E --\x3e T[Data Loaders]\r\n    E --\x3e U[Filter Actions]\n"})}),"\n",(0,a.jsx)(r.h2,{id:"state-categories",children:"State Categories"}),"\n",(0,a.jsx)(r.h3,{id:"entity-data",children:"Entity Data"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-typescript",children:"interface TrafficStore {\r\n    cameras: Camera[];\r\n    weather: Weather[];\r\n    airQuality: AirQuality[];\r\n    accidents: Accident[];\r\n    patterns: TrafficPattern[];\r\n    selectedCamera: Camera | null;\r\n    selectedAccident: Accident | null;\r\n    selectedPattern: TrafficPattern | null;\r\n}\n"})}),"\n",(0,a.jsx)(r.h3,{id:"derived-data",children:"Derived Data"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-typescript",children:"interface TrafficStore {\r\n    pollutants: PollutantData[];\r\n    humidityZones: HumidityZonesCollection | null;\r\n    vehicleHeatmap: VehicleHeatmapData | null;\r\n    speedZones: SpeedZonesCollection | null;\r\n    districts: District[];\r\n    selectedDistrict: string | null;\r\n    accidentFrequency: AccidentFrequencyData | null;\r\n}\n"})}),"\n",(0,a.jsx)(r.h3,{id:"ui-state",children:"UI State"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-typescript",children:"interface TrafficStore {\r\n    isConnected: boolean;\r\n    loading: boolean;\r\n    error: string | null;\r\n    filters: FilterState;\r\n    lastUpdate: Date | null;\r\n}\n"})}),"\n",(0,a.jsx)(r.h2,{id:"filter-state",children:"Filter State"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-typescript",children:"interface FilterState {\r\n    // Layer visibility\r\n    showCameras: boolean;\r\n    showWeather: boolean;\r\n    showAirQuality: boolean;\r\n    showAccidents: boolean;\r\n    showPatterns: boolean;\r\n    showAQIHeatmap: boolean;\r\n    showWeatherOverlay: boolean;\r\n    showAccidentMarkers: boolean;\r\n    showPatternZones: boolean;\r\n    showPollutantCircles: boolean;\r\n    showHumidityLayer: boolean;\r\n    showVehicleHeatmap: boolean;\r\n    showSpeedZones: boolean;\r\n    showCorrelationLines: boolean;\r\n    showAccidentFrequency: boolean;\r\n    showRoutePlanner: boolean;\r\n    \r\n    // AI Agents\r\n    showHealthAdvisor: boolean;\r\n    showInvestigator: boolean;\r\n    showPredictive: boolean;\r\n    \r\n    // Citizen Reports\r\n    showCitizenReports: boolean;\r\n    showCitizenForm: boolean;\r\n    \r\n    // Filters\r\n    districts: string[];\r\n    severityFilter: ('minor' | 'moderate' | 'severe' | 'fatal')[];\r\n    aqiLevelFilter: string[];\r\n    dateRange: {\r\n        start: Date | null;\r\n        end: Date | null;\r\n    };\r\n}\n"})}),"\n",(0,a.jsx)(r.h2,{id:"actions",children:"Actions"}),"\n",(0,a.jsx)(r.h3,{id:"data-management",children:"Data Management"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-typescript",children:"// Set entire arrays\r\nsetCameras: (cameras: Camera[]) => void;\r\nsetWeather: (weather: Weather[]) => void;\r\nsetAirQuality: (airQuality: AirQuality[]) => void;\r\nsetAccidents: (accidents: Accident[]) => void;\r\nsetPatterns: (patterns: TrafficPattern[]) => void;\r\n\r\n// Add individual items (for WebSocket updates)\r\naddCamera: (camera: Camera) => void;\r\naddWeather: (weather: Weather) => void;\r\naddAirQuality: (airQuality: AirQuality) => void;\r\naddAccident: (accident: Accident) => void;\r\naddPattern: (pattern: TrafficPattern) => void;\n"})}),"\n",(0,a.jsx)(r.h3,{id:"data-loading",children:"Data Loading"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-typescript",children:"// Load all data from API\r\nloadAllData: () => Promise<void>;\r\n\r\n// Refresh data (clears cache first)\r\nrefreshData: () => Promise<void>;\r\n\r\n// Load specific data types\r\nloadPollutants: (pollutantTypes?: string[]) => Promise<void>;\r\nloadHumidityZones: () => Promise<void>;\r\nloadVehicleHeatmap: (timeRange?: string) => Promise<void>;\r\nloadSpeedZones: (currentTime?: boolean) => Promise<void>;\r\nloadDistricts: () => Promise<void>;\r\nloadAccidentFrequency: (days?: number) => Promise<void>;\n"})}),"\n",(0,a.jsx)(r.h3,{id:"filter-actions",children:"Filter Actions"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-typescript",children:"toggleFilter: (filterName: keyof FilterState) => void;\r\nupdateFilters: (filters: Partial<FilterState>) => void;\r\nresetFilters: () => void;\n"})}),"\n",(0,a.jsx)(r.h3,{id:"computed-values",children:"Computed Values"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-typescript",children:"getFilteredCameras: () => Camera[];\r\ngetFilteredAccidents: () => Accident[];\r\ngetFilteredAirQuality: () => AirQuality[];\r\ngetActivePatterns: () => TrafficPattern[];\r\ngetAccidentsByDistrict: () => Record<string, Accident[]>;\r\ngetAverageAQI: () => number;\n"})}),"\n",(0,a.jsx)(r.h2,{id:"usage",children:"Usage"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-typescript",children:"import { useTrafficStore } from './store/trafficStore';\r\n\r\nfunction CameraList() {\r\n    // Subscribe to specific state\r\n    const cameras = useTrafficStore(state => state.cameras);\r\n    const loading = useTrafficStore(state => state.loading);\r\n    \r\n    // Get actions\r\n    const { refreshData, toggleFilter } = useTrafficStore();\r\n    \r\n    // Get filtered data\r\n    const filteredCameras = useTrafficStore(state => state.getFilteredCameras());\r\n    \r\n    return (\r\n        <div>\r\n            {loading && <Spinner />}\r\n            {cameras.map(camera => <CameraCard key={camera.id} camera={camera} />)}\r\n            <button onClick={refreshData}>Refresh</button>\r\n        </div>\r\n    );\r\n}\n"})}),"\n",(0,a.jsx)(r.h2,{id:"persistence",children:"Persistence"}),"\n",(0,a.jsx)(r.p,{children:"Store is persisted to localStorage:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-typescript",children:"export const useTrafficStore = create<TrafficStore>()(\r\n    persist(\r\n        (set, get) => ({\r\n            // ... state and actions\r\n        }),\r\n        {\r\n            name: 'traffic-store',\r\n            storage: createJSONStorage(() => localStorage),\r\n            partialize: (state) => ({\r\n                filters: state.filters,\r\n                // Only persist non-volatile state\r\n            }),\r\n        }\r\n    )\r\n);\n"})}),"\n",(0,a.jsx)(r.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"zustand@^4.4"}),": State management"]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"zustand/middleware"}),": Persistence middleware"]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"../services/api"}),": API service for data loading"]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"../types"}),": TypeScript interfaces"]}),"\n"]}),"\n",(0,a.jsx)(r.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,a.jsxs)(r.ol,{children:["\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.strong,{children:"Selectors"}),": Use selectors to subscribe to minimal state"]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.strong,{children:"Actions"}),": Use store actions rather than direct mutations"]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.strong,{children:"Computed"}),": Use getter methods for derived data"]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.strong,{children:"Persistence"}),": Only persist user preferences, not entity data"]}),"\n"]}),"\n",(0,a.jsx)(r.h2,{id:"see-also",children:"See Also"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsx)(r.li,{children:(0,a.jsx)(r.a,{href:"/tes/docs/frontend/services/api",children:"API Service"})}),"\n",(0,a.jsx)(r.li,{children:(0,a.jsx)(r.a,{href:"/tes/docs/frontend/services/websocket",children:"WebSocket Service"})}),"\n",(0,a.jsx)(r.li,{children:(0,a.jsx)(r.a,{href:"/tes/docs/frontend/types/",children:"Types Index"})}),"\n"]})]})}function h(e={}){const{wrapper:r}={...(0,i.R)(),...e.components};return r?(0,a.jsx)(r,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},8453:(e,r,n)=>{n.d(r,{R:()=>s,x:()=>l});var t=n(6540);const a={},i=t.createContext(a);function s(e){const r=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function l(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),t.createElement(i.Provider,{value:r},e.children)}}}]);