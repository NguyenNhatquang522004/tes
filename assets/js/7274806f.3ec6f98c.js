"use strict";(globalThis.webpackChunkuip_urban_intelligence_platform_docs=globalThis.webpackChunkuip_urban_intelligence_platform_docs||[]).push([[4805],{6525:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>o,frontMatter:()=>l,metadata:()=>t,toc:()=>h});const t=JSON.parse('{"id":"agents/monitoring/health-check","title":"health-check","description":"\x3c!--","source":"@site/docs/agents/monitoring/health-check.md","sourceDirName":"agents/monitoring","slug":"/agents/monitoring/health-check","permalink":"/tes/docs/agents/monitoring/health-check","draft":false,"unlisted":false,"editUrl":"https://github.com/NguyenNhatquang522004/UIP-Urban_Intelligence_Platform/tree/main/apps/traffic-web-app/frontend/docs/docs/agents/monitoring/health-check.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"neo4j-query","permalink":"/tes/docs/agents/graph-database/neo4j-query"},"next":{"title":"performance-monitor","permalink":"/tes/docs/agents/monitoring/performance-monitor"}}');var s=r(4848),i=r(8453);const l={sidebar_position:1},c="Health Check Agent",a={},h=[{value:"\ud83d\udccb Overview",id:"-overview",level:2},{value:"\ud83c\udfaf Purpose",id:"-purpose",level:2},{value:"\ud83d\udcca Monitoring Capabilities",id:"-monitoring-capabilities",level:2},{value:"Service Health Checks",id:"service-health-checks",level:3},{value:"Data Quality Metrics",id:"data-quality-metrics",level:3},{value:"\ud83d\udd27 Architecture",id:"-architecture",level:2},{value:"\ud83d\ude80 Usage",id:"-usage",level:2},{value:"Basic Health Check",id:"basic-health-check",level:3},{value:"Check Specific Service",id:"check-specific-service",level:3},{value:"Custom Health Checks",id:"custom-health-checks",level:3},{value:"\u2699\ufe0f Configuration",id:"\ufe0f-configuration",level:2},{value:"\ud83d\udcc8 Prometheus Metrics",id:"-prometheus-metrics",level:2},{value:"Grafana Dashboard",id:"grafana-dashboard",level:3},{value:"\ud83d\udee1\ufe0f Alerting",id:"\ufe0f-alerting",level:2},{value:"Alert Channels",id:"alert-channels",level:3},{value:"Alert Rules",id:"alert-rules",level:3},{value:"\ud83d\udcd6 Related Documentation",id:"-related-documentation",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"health-check-agent",children:"Health Check Agent"})}),"\n",(0,s.jsx)(n.p,{children:"The Health Check Agent provides comprehensive health monitoring for all services, data quality, and performance metrics with alerting capabilities."}),"\n",(0,s.jsx)(n.h2,{id:"-overview",children:"\ud83d\udccb Overview"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Property"}),(0,s.jsx)(n.th,{children:"Value"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Module"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"src.agents.monitoring.health_check_agent"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Class"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"HealthCheckAgent"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Author"})}),(0,s.jsx)(n.td,{children:"Nguyen Dinh Anh Tuan"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Version"})}),(0,s.jsx)(n.td,{children:"2.0.0"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"-purpose",children:"\ud83c\udfaf Purpose"}),"\n",(0,s.jsx)(n.p,{children:"The Health Check Agent provides:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Service availability monitoring"})," (HTTP, TCP, Cypher, SPARQL, Kafka)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Data quality validation"})," (thresholds, counts, age)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Performance metrics collection"})," (response times, latency)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Alerting integration"})," (webhook, email, Slack)"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Prometheus metrics export"})}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"-monitoring-capabilities",children:"\ud83d\udcca Monitoring Capabilities"}),"\n",(0,s.jsx)(n.h3,{id:"service-health-checks",children:"Service Health Checks"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Check Type"}),(0,s.jsx)(n.th,{children:"Protocol"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"HTTP"}),(0,s.jsx)(n.td,{children:"REST"}),(0,s.jsx)(n.td,{children:"API endpoint availability"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"TCP"}),(0,s.jsx)(n.td,{children:"Socket"}),(0,s.jsx)(n.td,{children:"Database connection"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Cypher"}),(0,s.jsx)(n.td,{children:"Neo4j"}),(0,s.jsx)(n.td,{children:"Graph database health"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"SPARQL"}),(0,s.jsx)(n.td,{children:"Fuseki"}),(0,s.jsx)(n.td,{children:"Triplestore availability"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Kafka"}),(0,s.jsx)(n.td,{children:"Broker"}),(0,s.jsx)(n.td,{children:"Message queue status"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"data-quality-metrics",children:"Data Quality Metrics"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Metric"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Data freshness"}),(0,s.jsx)(n.td,{children:"Age of latest data"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Record count"}),(0,s.jsx)(n.td,{children:"Expected vs actual counts"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Validation rate"}),(0,s.jsx)(n.td,{children:"Percentage passing validation"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Error rate"}),(0,s.jsx)(n.td,{children:"Failed operations"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"-architecture",children:"\ud83d\udd27 Architecture"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\r\n\u2502             Health Check Agent              \u2502\r\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\r\n\u2502                                             \u2502\r\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\r\n\u2502  \u2502  HTTP   \u2502  \u2502  TCP    \u2502  \u2502   Cypher    \u2502 \u2502\r\n\u2502  \u2502 Checker \u2502  \u2502 Checker \u2502  \u2502   Checker   \u2502 \u2502\r\n\u2502  \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\r\n\u2502       \u2502            \u2502              \u2502         \u2502\r\n\u2502       \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2502\r\n\u2502                    \u25bc                        \u2502\r\n\u2502           \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                 \u2502\r\n\u2502           \u2502 Health Status \u2502                 \u2502\r\n\u2502           \u2502   Aggregator  \u2502                 \u2502\r\n\u2502           \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                 \u2502\r\n\u2502                   \u2502                         \u2502\r\n\u2502       \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510            \u2502\r\n\u2502       \u25bc           \u25bc           \u25bc            \u2502\r\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510       \u2502\r\n\u2502  \u2502  Alert  \u2502 \u2502Prometheus\u2502 \u2502Dashboard\u2502       \u2502\r\n\u2502  \u2502 Manager \u2502 \u2502 Export  \u2502 \u2502   API   \u2502       \u2502\r\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518       \u2502\r\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,s.jsx)(n.h2,{id:"-usage",children:"\ud83d\ude80 Usage"}),"\n",(0,s.jsx)(n.h3,{id:"basic-health-check",children:"Basic Health Check"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"from src.agents.monitoring.health_check_agent import HealthCheckAgent\r\n\r\nagent = HealthCheckAgent()\r\n\r\n# Start continuous monitoring\r\nagent.start_monitoring()\r\n\r\n# Get current health status\r\nstatus = agent.get_health_status()\r\nprint(f\"Overall Health: {status['overall_health']}\")\r\nprint(f\"Services: {status['services']}\")\n"})}),"\n",(0,s.jsx)(n.h3,{id:"check-specific-service",children:"Check Specific Service"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'# Check single service\r\nneo4j_health = agent.check_service("neo4j")\r\nprint(f"Neo4j Status: {neo4j_health[\'status\']}")\r\nprint(f"Response Time: {neo4j_health[\'response_time_ms\']}ms")\r\n\r\n# Check database connection\r\nmongo_health = agent.check_database("mongodb")\n'})}),"\n",(0,s.jsx)(n.h3,{id:"custom-health-checks",children:"Custom Health Checks"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'# Register custom health check\r\n@agent.register_check("my_service")\r\nasync def check_my_service():\r\n    try:\r\n        response = await http_client.get("http://my-service/health")\r\n        return {"status": "healthy", "code": response.status_code}\r\n    except Exception as e:\r\n        return {"status": "unhealthy", "error": str(e)}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"\ufe0f-configuration",children:"\u2699\ufe0f Configuration"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'# config/health_check_config.yaml\r\nhealth_check:\r\n  enabled: true\r\n  check_interval_seconds: 30\r\n  \r\n  services:\r\n    backend:\r\n      url: http://localhost:8001/health\r\n      timeout: 5\r\n      expected_status: 200\r\n    \r\n    neo4j:\r\n      type: cypher\r\n      url: bolt://localhost:7687\r\n      query: "RETURN 1"\r\n      timeout: 10\r\n    \r\n    mongodb:\r\n      type: tcp\r\n      host: localhost\r\n      port: 27017\r\n      timeout: 5\r\n    \r\n    redis:\r\n      type: tcp\r\n      host: localhost\r\n      port: 6379\r\n      timeout: 3\r\n    \r\n    stellio:\r\n      url: http://localhost:8080/health\r\n      timeout: 10\r\n    \r\n    fuseki:\r\n      type: sparql\r\n      url: http://localhost:3030/traffic/sparql\r\n      query: "ASK { ?s ?p ?o }"\r\n      timeout: 10\r\n\r\n  # Alert configuration\r\n  alerts:\r\n    enabled: true\r\n    channels:\r\n      - type: webhook\r\n        url: http://alert-service/webhook\r\n      - type: email\r\n        recipients:\r\n          - admin@example.com\r\n    \r\n    rules:\r\n      - name: service_down\r\n        condition: status == "unhealthy"\r\n        severity: critical\r\n        cooldown_minutes: 5\r\n      \r\n      - name: high_latency\r\n        condition: response_time_ms > 5000\r\n        severity: warning\r\n        cooldown_minutes: 15\r\n\r\n  # Prometheus metrics\r\n  prometheus:\r\n    enabled: true\r\n    port: 9090\r\n    path: /metrics\n'})}),"\n",(0,s.jsx)(n.h2,{id:"-prometheus-metrics",children:"\ud83d\udcc8 Prometheus Metrics"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Metric"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"service_health_status"})}),(0,s.jsx)(n.td,{children:"Gauge"}),(0,s.jsx)(n.td,{children:"Binary health (0=down, 1=up)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"service_response_time_seconds"})}),(0,s.jsx)(n.td,{children:"Histogram"}),(0,s.jsx)(n.td,{children:"Health check latency"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"data_quality_score"})}),(0,s.jsx)(n.td,{children:"Gauge"}),(0,s.jsx)(n.td,{children:"Quality metric (0-100)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"health_check_total"})}),(0,s.jsx)(n.td,{children:"Counter"}),(0,s.jsx)(n.td,{children:"Total checks performed"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"grafana-dashboard",children:"Grafana Dashboard"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\r\n  "panels": [\r\n    {\r\n      "title": "Service Health",\r\n      "type": "stat",\r\n      "targets": [\r\n        {\r\n          "expr": "service_health_status"\r\n        }\r\n      ]\r\n    }\r\n  ]\r\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"\ufe0f-alerting",children:"\ud83d\udee1\ufe0f Alerting"}),"\n",(0,s.jsx)(n.h3,{id:"alert-channels",children:"Alert Channels"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'# Configure alert channels\r\nagent.configure_alerts({\r\n    "webhook": {\r\n        "url": "https://hooks.slack.com/services/xxx",\r\n        "headers": {"Content-Type": "application/json"}\r\n    },\r\n    "email": {\r\n        "smtp_server": "smtp.example.com",\r\n        "recipients": ["ops@example.com"]\r\n    }\r\n})\n'})}),"\n",(0,s.jsx)(n.h3,{id:"alert-rules",children:"Alert Rules"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'# Custom alert rule\r\nagent.add_alert_rule(\r\n    name="database_slow",\r\n    condition=lambda status: status.get("response_time_ms", 0) > 1000,\r\n    severity="warning",\r\n    message="Database response time exceeded 1 second"\r\n)\n'})}),"\n",(0,s.jsx)(n.h2,{id:"-related-documentation",children:"\ud83d\udcd6 Related Documentation"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"performance-monitor",children:"Performance Monitor"})," - Performance metrics"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"data-quality-validator",children:"Data Quality Validator"})," - Data validation"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"../../devops/complete-devops-guide",children:"DevOps Guide"})," - Monitoring setup"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsxs)(n.p,{children:["See the ",(0,s.jsx)(n.a,{href:"../complete-agents-reference",children:"complete agents reference"})," for all available agents."]})]})}function o(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>l,x:()=>c});var t=r(6540);const s={},i=t.createContext(s);function l(e){const n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);