"use strict";(globalThis.webpackChunkuip_urban_intelligence_platform_docs=globalThis.webpackChunkuip_urban_intelligence_platform_docs||[]).push([[8114],{972:(n,r,e)=>{e.r(r),e.d(r,{assets:()=>c,contentTitle:()=>a,default:()=>g,frontMatter:()=>t,metadata:()=>o,toc:()=>l});const o=JSON.parse('{"id":"backend/config/config-loader","title":"Config Loader","description":"Configuration loader for environment variables, database connections, and external service settings with validation and defaults.","source":"@site/docs/backend/config/configLoader.md","sourceDirName":"backend/config","slug":"/backend/config/config-loader","permalink":"/tes/docs/backend/config/config-loader","draft":false,"unlisted":false,"editUrl":"https://github.com/NguyenNhatquang522004/UIP-Urban_Intelligence_Platform/tree/main/apps/traffic-web-app/frontend/docs/docs/backend/config/configLoader.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"id":"config-loader","title":"Config Loader","sidebar_label":"Config Loader","sidebar_position":1,"description":"Configuration loader for environment variables, database connections, and external service settings with validation and defaults.","keywords":["config","configuration","environment","dotenv","validation"]}}');var i=e(4848),s=e(8453);const t={id:"config-loader",title:"Config Loader",sidebar_label:"Config Loader",sidebar_position:1,description:"Configuration loader for environment variables, database connections, and external service settings with validation and defaults.",keywords:["config","configuration","environment","dotenv","validation"]},a="Config Loader",c={},l=[{value:"Overview",id:"overview",level:2},{value:"Configuration Interface",id:"configuration-interface",level:2},{value:"Configuration Loading",id:"configuration-loading",level:2},{value:"Validation",id:"validation",level:2},{value:"Environment File",id:"environment-file",level:2},{value:"Usage",id:"usage",level:2},{value:"Related Documentation",id:"related-documentation",level:2},{value:"References",id:"references",level:2}];function d(n){const r={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.header,{children:(0,i.jsx)(r.h1,{id:"config-loader",children:"Config Loader"})}),"\n",(0,i.jsxs)(r.p,{children:["Configuration loader for ",(0,i.jsx)(r.strong,{children:"environment variables"}),", database connections, and external service settings with validation and defaults."]}),"\n",(0,i.jsx)(r.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-mermaid",children:"graph TB\r\n    subgraph Sources\r\n        ENV[.env File]\r\n        ENVVAR[Environment Variables]\r\n        DEFAULTS[Default Values]\r\n    end\r\n    \r\n    subgraph ConfigLoader\r\n        LOAD[Load & Merge]\r\n        VALIDATE[Validate]\r\n        EXPORT[Export Config]\r\n    end\r\n    \r\n    subgraph Consumers\r\n        SERVER[Express Server]\r\n        SERVICES[Services]\r\n        AGENTS[AI Agents]\r\n    end\r\n    \r\n    ENV --\x3e LOAD\r\n    ENVVAR --\x3e LOAD\r\n    DEFAULTS --\x3e LOAD\r\n    LOAD --\x3e VALIDATE\r\n    VALIDATE --\x3e EXPORT\r\n    EXPORT --\x3e SERVER\r\n    EXPORT --\x3e SERVICES\r\n    EXPORT --\x3e AGENTS\n"})}),"\n",(0,i.jsx)(r.h2,{id:"configuration-interface",children:"Configuration Interface"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-typescript",children:"// config/configLoader.ts\r\nexport interface Config {\r\n  // Server\r\n  server: {\r\n    port: number;\r\n    host: string;\r\n    corsOrigins: string[];\r\n    env: 'development' | 'production' | 'test';\r\n  };\r\n  \r\n  // Stellio Context Broker\r\n  stellio: {\r\n    url: string;\r\n    context: string;\r\n    timeout: number;\r\n  };\r\n  \r\n  // Neo4j Graph Database\r\n  neo4j: {\r\n    uri: string;\r\n    user: string;\r\n    password: string;\r\n  };\r\n  \r\n  // Apache Jena Fuseki\r\n  fuseki: {\r\n    url: string;\r\n    dataset: string;\r\n  };\r\n  \r\n  // PostgreSQL / TimescaleDB\r\n  postgres: {\r\n    host: string;\r\n    port: number;\r\n    database: string;\r\n    user: string;\r\n    password: string;\r\n    ssl: boolean;\r\n  };\r\n  \r\n  // Google Gemini AI\r\n  gemini: {\r\n    apiKey: string;\r\n    model: string;\r\n    maxTokens: number;\r\n  };\r\n  \r\n  // Tavily Search\r\n  tavily: {\r\n    apiKey: string;\r\n    searchDepth: 'basic' | 'advanced';\r\n  };\r\n  \r\n  // Cache\r\n  cache: {\r\n    enabled: boolean;\r\n    ttl: number;\r\n    maxSize: number;\r\n  };\r\n  \r\n  // Logging\r\n  logging: {\r\n    level: string;\r\n    format: 'json' | 'simple';\r\n    dir: string;\r\n  };\r\n}\n"})}),"\n",(0,i.jsx)(r.h2,{id:"configuration-loading",children:"Configuration Loading"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-typescript",children:"import dotenv from 'dotenv';\r\nimport path from 'path';\r\n\r\n// Load .env file\r\ndotenv.config({ path: path.resolve(__dirname, '../../.env') });\r\n\r\nexport function loadConfig(): Config {\r\n  return {\r\n    server: {\r\n      port: parseInt(process.env.PORT || '5000'),\r\n      host: process.env.HOST || '0.0.0.0',\r\n      corsOrigins: (process.env.CORS_ORIGINS || '*').split(','),\r\n      env: (process.env.NODE_ENV as any) || 'development'\r\n    },\r\n    \r\n    stellio: {\r\n      url: process.env.STELLIO_URL || 'http://localhost:8080',\r\n      context: process.env.NGSI_LD_CONTEXT || \r\n        'https://uri.etsi.org/ngsi-ld/v1/ngsi-ld-core-context.jsonld',\r\n      timeout: parseInt(process.env.STELLIO_TIMEOUT || '30000')\r\n    },\r\n    \r\n    neo4j: {\r\n      uri: process.env.NEO4J_URI || 'bolt://localhost:7687',\r\n      user: process.env.NEO4J_USER || 'neo4j',\r\n      password: process.env.NEO4J_PASSWORD || 'password'\r\n    },\r\n    \r\n    fuseki: {\r\n      url: process.env.FUSEKI_URL || 'http://localhost:3030',\r\n      dataset: process.env.FUSEKI_DATASET || 'uip'\r\n    },\r\n    \r\n    postgres: {\r\n      host: process.env.PG_HOST || 'localhost',\r\n      port: parseInt(process.env.PG_PORT || '5432'),\r\n      database: process.env.PG_DATABASE || 'uip',\r\n      user: process.env.PG_USER || 'postgres',\r\n      password: process.env.PG_PASSWORD || 'password',\r\n      ssl: process.env.PG_SSL === 'true'\r\n    },\r\n    \r\n    gemini: {\r\n      apiKey: process.env.GEMINI_API_KEY || '',\r\n      model: process.env.GEMINI_MODEL || 'gemini-2.0-flash-exp',\r\n      maxTokens: parseInt(process.env.GEMINI_MAX_TOKENS || '8192')\r\n    },\r\n    \r\n    tavily: {\r\n      apiKey: process.env.TAVILY_API_KEY || '',\r\n      searchDepth: (process.env.TAVILY_DEPTH as any) || 'basic'\r\n    },\r\n    \r\n    cache: {\r\n      enabled: process.env.CACHE_ENABLED !== 'false',\r\n      ttl: parseInt(process.env.CACHE_TTL || '300'),  // 5 minutes\r\n      maxSize: parseInt(process.env.CACHE_MAX_SIZE || '1000')\r\n    },\r\n    \r\n    logging: {\r\n      level: process.env.LOG_LEVEL || 'info',\r\n      format: (process.env.LOG_FORMAT as any) || 'json',\r\n      dir: process.env.LOG_DIR || './logs'\r\n    }\r\n  };\r\n}\r\n\r\n// Export singleton config\r\nexport const config = loadConfig();\n"})}),"\n",(0,i.jsx)(r.h2,{id:"validation",children:"Validation"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-typescript",children:"export function validateConfig(config: Config): void {\r\n  const errors: string[] = [];\r\n  \r\n  // Required API keys\r\n  if (!config.gemini.apiKey) {\r\n    errors.push('GEMINI_API_KEY is required');\r\n  }\r\n  \r\n  // Validate port range\r\n  if (config.server.port < 1 || config.server.port > 65535) {\r\n    errors.push('PORT must be between 1 and 65535');\r\n  }\r\n  \r\n  // Validate URLs\r\n  try {\r\n    new URL(config.stellio.url);\r\n  } catch {\r\n    errors.push('STELLIO_URL is not a valid URL');\r\n  }\r\n  \r\n  if (errors.length > 0) {\r\n    throw new Error(`Configuration errors:\\n${errors.join('\\n')}`);\r\n  }\r\n}\n"})}),"\n",(0,i.jsx)(r.h2,{id:"environment-file",children:"Environment File"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:"# .env.example\r\n\r\n# Server\r\nPORT=5000\r\nHOST=0.0.0.0\r\nNODE_ENV=development\r\nCORS_ORIGINS=http://localhost:3000\r\n\r\n# Stellio Context Broker\r\nSTELLIO_URL=http://localhost:8080\r\nNGSI_LD_CONTEXT=https://uri.etsi.org/ngsi-ld/v1/ngsi-ld-core-context.jsonld\r\nSTELLIO_TIMEOUT=30000\r\n\r\n# Neo4j\r\nNEO4J_URI=bolt://localhost:7687\r\nNEO4J_USER=neo4j\r\nNEO4J_PASSWORD=your-password\r\n\r\n# Fuseki\r\nFUSEKI_URL=http://localhost:3030\r\nFUSEKI_DATASET=uip\r\n\r\n# PostgreSQL / TimescaleDB\r\nPG_HOST=localhost\r\nPG_PORT=5432\r\nPG_DATABASE=uip\r\nPG_USER=postgres\r\nPG_PASSWORD=your-password\r\nPG_SSL=false\r\n\r\n# Google Gemini AI\r\nGEMINI_API_KEY=your-gemini-key\r\nGEMINI_MODEL=gemini-2.0-flash-exp\r\nGEMINI_MAX_TOKENS=8192\r\n\r\n# Tavily Search\r\nTAVILY_API_KEY=your-tavily-key\r\nTAVILY_DEPTH=basic\r\n\r\n# Cache\r\nCACHE_ENABLED=true\r\nCACHE_TTL=300\r\nCACHE_MAX_SIZE=1000\r\n\r\n# Logging\r\nLOG_LEVEL=info\r\nLOG_FORMAT=json\r\nLOG_DIR=./logs\n"})}),"\n",(0,i.jsx)(r.h2,{id:"usage",children:"Usage"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-typescript",children:"import { config } from './config/configLoader';\r\n\r\n// In server.ts\r\napp.listen(config.server.port, config.server.host, () => {\r\n  logger.info(`Server started on ${config.server.host}:${config.server.port}`);\r\n});\r\n\r\n// In services\r\nconst driver = neo4j.driver(\r\n  config.neo4j.uri,\r\n  neo4j.auth.basic(config.neo4j.user, config.neo4j.password)\r\n);\r\n\r\n// In agents\r\nconst genAI = new GoogleGenerativeAI(config.gemini.apiKey);\r\nconst model = genAI.getGenerativeModel({ model: config.gemini.model });\n"})}),"\n",(0,i.jsx)(r.h2,{id:"related-documentation",children:"Related Documentation"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.a,{href:"/tes/docs/backend/overview",children:"Backend Overview"})," - Server architecture"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.a,{href:"/tes/docs/backend/services/stellio-service",children:"Services"})," - Service configuration"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.a,{href:"/tes/docs/backend/agents/EcoTwinAgent",children:"AI Agents"})," - Agent configuration"]}),"\n"]}),"\n",(0,i.jsx)(r.h2,{id:"references",children:"References"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:(0,i.jsx)(r.a,{href:"https://github.com/motdotla/dotenv",children:"dotenv"})}),"\n",(0,i.jsx)(r.li,{children:(0,i.jsx)(r.a,{href:"https://12factor.net/config",children:"12-Factor App Config"})}),"\n"]})]})}function g(n={}){const{wrapper:r}={...(0,s.R)(),...n.components};return r?(0,i.jsx)(r,{...n,children:(0,i.jsx)(d,{...n})}):d(n)}},8453:(n,r,e)=>{e.d(r,{R:()=>t,x:()=>a});var o=e(6540);const i={},s=o.createContext(i);function t(n){const r=o.useContext(s);return o.useMemo(function(){return"function"==typeof n?n(r):{...r,...n}},[r,n])}function a(n){let r;return r=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:t(n.components),o.createElement(s.Provider,{value:r},n.children)}}}]);