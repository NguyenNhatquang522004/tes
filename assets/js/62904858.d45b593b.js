"use strict";(globalThis.webpackChunkuip_urban_intelligence_platform_docs=globalThis.webpackChunkuip_urban_intelligence_platform_docs||[]).push([[3651],{8443:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>d,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"backend/overview","title":"Backend Overview","description":"Express API server with WebSocket support for real-time traffic monitoring","source":"@site/docs/backend/overview.md","sourceDirName":"backend","slug":"/backend/overview","permalink":"/tes/docs/backend/overview","draft":false,"unlisted":false,"editUrl":"https://github.com/NguyenNhatquang522004/UIP-Urban_Intelligence_Platform/tree/main/apps/traffic-web-app/frontend/docs/docs/backend/overview.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"Backend Overview","description":"Express API server with WebSocket support for real-time traffic monitoring"}}');var i=r(4848),s=r(8453);const d={sidebar_position:1,title:"Backend Overview",description:"Express API server with WebSocket support for real-time traffic monitoring"},l="Backend Overview",c={},a=[{value:"Architecture",id:"architecture",level:2},{value:"Key Features",id:"key-features",level:2},{value:"RESTful API",id:"restful-api",level:3},{value:"Real-Time Updates",id:"real-time-updates",level:3},{value:"AI Agents",id:"ai-agents",level:3},{value:"Multi-Database Integration",id:"multi-database-integration",level:3},{value:"Source Structure",id:"source-structure",level:2},{value:"Technology Stack",id:"technology-stack",level:2},{value:"Environment Configuration",id:"environment-configuration",level:2},{value:"Quick Start",id:"quick-start",level:2},{value:"API Endpoints",id:"api-endpoints",level:2},{value:"Health Check",id:"health-check",level:2},{value:"See Also",id:"see-also",level:2}];function o(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:["\n",(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"backend-overview",children:"Backend Overview"})}),"\n",(0,i.jsx)(n.p,{children:"Express API server providing REST endpoints and WebSocket real-time updates for traffic monitoring, integrating with Stellio Context Broker, Neo4j, Fuseki, and PostgreSQL."}),"\n",(0,i.jsx)(n.h2,{id:"architecture",children:"Architecture"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-mermaid",children:'graph TB\r\n    subgraph "Express Backend :5000"\r\n        A[server.ts] --\x3e B[Routes]\r\n        A --\x3e C[Services]\r\n        A --\x3e D[Agents]\r\n        A --\x3e E[WebSocket Server]\r\n        \r\n        B --\x3e B1[Camera Routes]\r\n        B --\x3e B2[Weather Routes]\r\n        B --\x3e B3[AirQuality Routes]\r\n        B --\x3e B4[Accident Routes]\r\n        B --\x3e B5[Pattern Routes]\r\n        B --\x3e B6[Analytics Routes]\r\n        B --\x3e B7[Agent Routes]\r\n        \r\n        C --\x3e C1[StellioService]\r\n        C --\x3e C2[Neo4jService]\r\n        C --\x3e C3[FusekiService]\r\n        C --\x3e C4[PostgresService]\r\n        C --\x3e C5[WebSocketService]\r\n        C --\x3e C6[DataAggregator]\r\n        \r\n        D --\x3e D1[EcoTwinAgent]\r\n        D --\x3e D2[GraphInvestigatorAgent]\r\n        D --\x3e D3[TrafficMaestroAgent]\r\n    end\r\n    \r\n    subgraph "External Services"\r\n        F[(Stellio Context Broker)]\r\n        G[(Neo4j Graph DB)]\r\n        H[(Fuseki SPARQL)]\r\n        I[(PostgreSQL/TimescaleDB)]\r\n        J[Google Gemini AI]\r\n        K[Tavily Search API]\r\n    end\r\n    \r\n    C1 --\x3e F\r\n    C2 --\x3e G\r\n    C3 --\x3e H\r\n    C4 --\x3e I\r\n    D1 --\x3e J\r\n    D2 --\x3e J\r\n    D2 --\x3e K\r\n    D3 --\x3e J\n'})}),"\n",(0,i.jsx)(n.h2,{id:"key-features",children:"Key Features"}),"\n",(0,i.jsx)(n.h3,{id:"restful-api",children:"RESTful API"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"12 endpoint groups"})," covering all traffic data types"]}),"\n",(0,i.jsx)(n.li,{children:"CORS-enabled for frontend integration"}),"\n",(0,i.jsx)(n.li,{children:"Request validation with structured error handling"}),"\n",(0,i.jsxs)(n.li,{children:["YAML-driven configuration (",(0,i.jsx)(n.code,{children:"config/entities.yaml"}),")"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"real-time-updates",children:"Real-Time Updates"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"WebSocket server for bidirectional communication"}),"\n",(0,i.jsx)(n.li,{children:"Topic-based pub/sub (cameras, weather, accidents, etc.)"}),"\n",(0,i.jsx)(n.li,{children:"Heartbeat mechanism with 30s timeout"}),"\n",(0,i.jsx)(n.li,{children:"Automatic reconnection handling"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"ai-agents",children:"AI Agents"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"EcoTwin"}),": Environmental health advisor with AQI dispersion modeling"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"GraphInvestigator"}),": Multimodal incident analysis with GraphRAG"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"TrafficMaestro"}),": Predictive event-based congestion forecasting"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"multi-database-integration",children:"Multi-Database Integration"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Stellio"}),": NGSI-LD entities (primary data source)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Neo4j"}),": Graph relationships and correlations"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Fuseki"}),": SPARQL queries and LOD enrichment"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"PostgreSQL"}),": Temporal data and analytics"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"source-structure",children:"Source Structure"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"backend/src/\r\n\u251c\u2500\u2500 server.ts           # Main Express server entry point\r\n\u251c\u2500\u2500 agents/             # AI agents (3 files)\r\n\u2502   \u251c\u2500\u2500 EcoTwinAgent.ts\r\n\u2502   \u251c\u2500\u2500 GraphInvestigatorAgent.ts\r\n\u2502   \u2514\u2500\u2500 TrafficMaestroAgent.ts\r\n\u251c\u2500\u2500 config/             # Configuration loader\r\n\u2502   \u2514\u2500\u2500 configLoader.ts\r\n\u251c\u2500\u2500 middlewares/        # Express middlewares\r\n\u2502   \u2514\u2500\u2500 errorHandler.ts\r\n\u251c\u2500\u2500 routes/             # API route handlers (12 files)\r\n\u2502   \u251c\u2500\u2500 cameraRoutes.ts\r\n\u2502   \u251c\u2500\u2500 weatherRoutes.ts\r\n\u2502   \u251c\u2500\u2500 airQualityRoutes.ts\r\n\u2502   \u2514\u2500\u2500 ...\r\n\u251c\u2500\u2500 services/           # Data services (7 files)\r\n\u2502   \u251c\u2500\u2500 stellioService.ts\r\n\u2502   \u251c\u2500\u2500 neo4jService.ts\r\n\u2502   \u251c\u2500\u2500 fusekiService.ts\r\n\u2502   \u2514\u2500\u2500 ...\r\n\u251c\u2500\u2500 types/              # TypeScript definitions\r\n\u2502   \u2514\u2500\u2500 index.ts\r\n\u2514\u2500\u2500 utils/              # Utility functions (5 files)\r\n    \u251c\u2500\u2500 logger.ts\r\n    \u251c\u2500\u2500 healthCheck.ts\r\n    \u2514\u2500\u2500 ...\n"})}),"\n",(0,i.jsx)(n.h2,{id:"technology-stack",children:"Technology Stack"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Component"}),(0,i.jsx)(n.th,{children:"Technology"}),(0,i.jsx)(n.th,{children:"Version"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Runtime"}),(0,i.jsx)(n.td,{children:"Node.js"}),(0,i.jsx)(n.td,{children:"18+"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Framework"}),(0,i.jsx)(n.td,{children:"Express"}),(0,i.jsx)(n.td,{children:"4.18+"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Language"}),(0,i.jsx)(n.td,{children:"TypeScript"}),(0,i.jsx)(n.td,{children:"5.1+"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"WebSocket"}),(0,i.jsx)(n.td,{children:"ws"}),(0,i.jsx)(n.td,{children:"8.14+"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Database Clients"}),(0,i.jsx)(n.td,{children:"neo4j-driver, pg, sparql-http-client"}),(0,i.jsx)(n.td,{children:"-"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"AI SDK"}),(0,i.jsx)(n.td,{children:"@google/generative-ai"}),(0,i.jsx)(n.td,{children:"0.21+"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Logging"}),(0,i.jsx)(n.td,{children:"Winston"}),(0,i.jsx)(n.td,{children:"3.11+"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"environment-configuration",children:"Environment Configuration"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Server\r\nPORT=5000\r\nNODE_ENV=development\r\n\r\n# CORS\r\nCORS_ORIGIN=http://localhost:5173,http://localhost:3000\r\n\r\n# Stellio Context Broker\r\nSTELLIO_URL=http://localhost:8080\r\nSTELLIO_NGSI_LD_PATH=/ngsi-ld/v1\r\n\r\n# Neo4j\r\nNEO4J_URL=bolt://localhost:7687\r\nNEO4J_USER=neo4j\r\nNEO4J_PASSWORD=test12345\r\n\r\n# Fuseki\r\nFUSEKI_URL=http://localhost:3030\r\nFUSEKI_DATASET=lod-dataset\r\n\r\n# PostgreSQL\r\nPOSTGRES_HOST=localhost\r\nPOSTGRES_PORT=5432\r\nPOSTGRES_DB=stellio_search\r\n\r\n# AI APIs\r\nGEMINI_API_KEY=your_key_here\r\nTAVILY_API_KEY=your_key_here\n"})}),"\n",(0,i.jsx)(n.h2,{id:"quick-start",children:"Quick Start"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Install dependencies\r\ncd apps/traffic-web-app/backend\r\nnpm install\r\n\r\n# Development mode\r\nnpm run dev\r\n\r\n# Production build\r\nnpm run build\r\nnpm start\r\n\r\n# Run tests\r\nnpm test\n"})}),"\n",(0,i.jsx)(n.h2,{id:"api-endpoints",children:"API Endpoints"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Group"}),(0,i.jsx)(n.th,{children:"Base Path"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Cameras"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/api/cameras"})}),(0,i.jsx)(n.td,{children:"Traffic camera entities"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Weather"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/api/weather"})}),(0,i.jsx)(n.td,{children:"Weather observations"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Air Quality"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/api/air-quality"})}),(0,i.jsx)(n.td,{children:"AQI and pollutant data"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Accidents"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/api/accidents"})}),(0,i.jsx)(n.td,{children:"Road accident events"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Patterns"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/api/patterns"})}),(0,i.jsx)(n.td,{children:"Traffic congestion patterns"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Analytics"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/api/analytics"})}),(0,i.jsx)(n.td,{children:"Aggregated metrics"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Historical"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/api/historical"})}),(0,i.jsx)(n.td,{children:"Time-series data"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Correlation"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/api/correlation"})}),(0,i.jsx)(n.td,{children:"Entity relationships"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Routing"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/api/routing"})}),(0,i.jsx)(n.td,{children:"Route planning"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Geocoding"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/api/geocoding"})}),(0,i.jsx)(n.td,{children:"Address conversion"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Agents"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/api/agents"})}),(0,i.jsx)(n.td,{children:"AI agent queries"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Multi-Agent"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/api/multi-agent"})}),(0,i.jsx)(n.td,{children:"Combined agent analysis"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"health-check",children:"Health Check"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"curl http://localhost:5000/health\n"})}),"\n",(0,i.jsx)(n.p,{children:"Returns connectivity status for all backend services."}),"\n",(0,i.jsx)(n.h2,{id:"see-also",children:"See Also"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"./agents/",children:"Agents Documentation"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"./services/",children:"Services Documentation"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"./routes/",children:"Routes Documentation"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"/docs/api/complete-api-reference",children:"API Reference"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>d,x:()=>l});var t=r(6540);const i={},s=t.createContext(i);function d(e){const n=t.useContext(s);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);