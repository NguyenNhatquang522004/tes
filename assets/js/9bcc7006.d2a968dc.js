"use strict";(globalThis.webpackChunkuip_urban_intelligence_platform_docs=globalThis.webpackChunkuip_urban_intelligence_platform_docs||[]).push([[8643],{4136:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>h,frontMatter:()=>c,metadata:()=>s,toc:()=>o});var s=t(7821),i=t(4848),a=t(8453);const c={slug:"agent-system-deep-dive",title:"\ud83e\udd16 Deep Dive v\xe0o Agent System c\u1ee7a UIP",authors:["nguyennhatquang"],tags:["uip","architecture","agents","python","technical"]},r="Kh\xe1m ph\xe1 Agent System - Tr\xe1i tim c\u1ee7a UIP \ud83d\udca1",l={authorsImageUrls:[void 0]},o=[{value:"\ud83c\udfaf T\u1ea1i sao s\u1eed d\u1ee5ng Agent Architecture?",id:"-t\u1ea1i-sao-s\u1eed-d\u1ee5ng-agent-architecture",level:2},{value:"\ud83c\udfd7\ufe0f C\u1ea5u tr\xfac Agent",id:"\ufe0f-c\u1ea5u-tr\xfac-agent",level:2},{value:"Base Agent Interface",id:"base-agent-interface",level:3},{value:"\ud83d\udcca C\xe1c lo\u1ea1i Agent trong UIP",id:"-c\xe1c-lo\u1ea1i-agent-trong-uip",level:2},{value:"1. Data Collection Agents \ud83d\udce5",id:"1-data-collection-agents-",level:3},{value:"2. Analytics Agents \ud83d\udcc8",id:"2-analytics-agents-",level:3},{value:"3. Transformation Agents \ud83d\udd04",id:"3-transformation-agents-",level:3},{value:"4. RDF/LOD Agents \ud83d\udd17",id:"4-rdflod-agents-",level:3},{value:"\ud83d\udd04 Orchestrator - \u0110i\u1ec1u ph\u1ed1i vi\xean",id:"-orchestrator---\u0111i\u1ec1u-ph\u1ed1i-vi\xean",level:2},{value:"\ud83d\udcc8 Performance Metrics",id:"-performance-metrics",level:2},{value:"\ud83c\udf93 Lessons Learned",id:"-lessons-learned",level:2},{value:"\ud83d\ude80 K\u1ebft lu\u1eadn",id:"-k\u1ebft-lu\u1eadn",level:2}];function d(e){const n={a:"a",code:"code",em:"em",h2:"h2",h3:"h3",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:["Trong b\xe0i vi\u1ebft n\xe0y, t\xf4i s\u1ebd chia s\u1ebb chi ti\u1ebft v\u1ec1 ",(0,i.jsx)(n.strong,{children:"Agent System"})," - th\xe0nh ph\u1ea7n c\u1ed1t l\xf5i gi\xfap UIP ho\u1ea1t \u0111\u1ed9ng m\u1ea1nh m\u1ebd v\xe0 linh ho\u1ea1t."]}),"\n",(0,i.jsx)(n.h2,{id:"-t\u1ea1i-sao-s\u1eed-d\u1ee5ng-agent-architecture",children:"\ud83c\udfaf T\u1ea1i sao s\u1eed d\u1ee5ng Agent Architecture?"}),"\n",(0,i.jsx)(n.p,{children:"Khi thi\u1ebft k\u1ebf UIP, ch\xfang t\xf4i \u0111\u1ed1i m\u1eb7t v\u1edbi nhi\u1ec1u th\xe1ch th\u1ee9c:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"X\u1eed l\xfd song song"})," - C\u1ea7n x\u1eed l\xfd d\u1eef li\u1ec7u t\u1eeb 1000+ camera"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Modular"})," - D\u1ec5 th\xeam/b\u1edbt t\xednh n\u0103ng"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Fault Tolerant"})," - M\u1ed9t agent l\u1ed7i kh\xf4ng \u1ea3nh h\u01b0\u1edfng to\xe0n h\u1ec7 th\u1ed1ng"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Scalable"})," - M\u1edf r\u1ed9ng theo nhu c\u1ea7u"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Agent Architecture"})," l\xe0 gi\u1ea3i ph\xe1p ho\xe0n h\u1ea3o!"]}),"\n",(0,i.jsx)(n.h2,{id:"\ufe0f-c\u1ea5u-tr\xfac-agent",children:"\ud83c\udfd7\ufe0f C\u1ea5u tr\xfac Agent"}),"\n",(0,i.jsx)(n.h3,{id:"base-agent-interface",children:"Base Agent Interface"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'from abc import ABC, abstractmethod\nfrom dataclasses import dataclass\nfrom enum import Enum\n\nclass AgentStatus(Enum):\n    SUCCESS = "success"\n    FAILURE = "failure"\n    PARTIAL = "partial"\n    SKIPPED = "skipped"\n\n@dataclass\nclass AgentResult:\n    status: AgentStatus\n    data: dict\n    errors: list\n    execution_time: float\n\nclass BaseAgent(ABC):\n    """Base class cho t\u1ea5t c\u1ea3 agents trong UIP"""\n    \n    def __init__(self, config: dict):\n        self.config = config\n        self.logger = self._setup_logger()\n    \n    @abstractmethod\n    async def execute(self, context: dict) -> AgentResult:\n        """Execute agent logic"""\n        pass\n    \n    async def pre_execute(self, context: dict) -> bool:\n        """Hook tr\u01b0\u1edbc khi execute"""\n        return True\n    \n    async def post_execute(self, result: AgentResult) -> None:\n        """Hook sau khi execute"""\n        pass\n'})}),"\n",(0,i.jsx)(n.h2,{id:"-c\xe1c-lo\u1ea1i-agent-trong-uip",children:"\ud83d\udcca C\xe1c lo\u1ea1i Agent trong UIP"}),"\n",(0,i.jsx)(n.h3,{id:"1-data-collection-agents-",children:"1. Data Collection Agents \ud83d\udce5"}),"\n",(0,i.jsx)(n.p,{children:"Thu th\u1eadp d\u1eef li\u1ec7u t\u1eeb nhi\u1ec1u ngu\u1ed3n:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Agent"}),(0,i.jsx)(n.th,{children:"Ch\u1ee9c n\u0103ng"}),(0,i.jsx)(n.th,{children:"Frequency"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"ImageRefreshAgent"})}),(0,i.jsx)(n.td,{children:"L\u1ea5y \u1ea3nh t\u1eeb camera"}),(0,i.jsx)(n.td,{children:"5s"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"WeatherIntegrationAgent"})}),(0,i.jsx)(n.td,{children:"D\u1eef li\u1ec7u th\u1eddi ti\u1ebft"}),(0,i.jsx)(n.td,{children:"10m"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"AirQualityAgent"})}),(0,i.jsx)(n.td,{children:"Ch\u1ec9 s\u1ed1 AQI"}),(0,i.jsx)(n.td,{children:"30m"})]})]})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'class ImageRefreshAgent(BaseAgent):\n    """Refresh camera images from HCM traffic system"""\n    \n    async def execute(self, context: dict) -> AgentResult:\n        cameras = await self.fetch_camera_list()\n        \n        async with aiohttp.ClientSession() as session:\n            tasks = [\n                self.fetch_image(session, cam) \n                for cam in cameras\n            ]\n            results = await asyncio.gather(*tasks)\n        \n        return AgentResult(\n            status=AgentStatus.SUCCESS,\n            data={"images": results, "count": len(results)},\n            errors=[],\n            execution_time=time.time() - start\n        )\n'})}),"\n",(0,i.jsx)(n.h3,{id:"2-analytics-agents-",children:"2. Analytics Agents \ud83d\udcc8"}),"\n",(0,i.jsx)(n.p,{children:"Ph\xe2n t\xedch d\u1eef li\u1ec7u th\xf4ng minh:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"CVAnalysisAgent"})})," - Ph\xe2n t\xedch h\xecnh \u1ea3nh v\u1edbi YOLOX"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"AccidentDetectionAgent"})})," - Ph\xe1t hi\u1ec7n tai n\u1ea1n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"CongestionDetectionAgent"})})," - Ph\xe1t hi\u1ec7n \xf9n t\u1eafc"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"PatternRecognitionAgent"})})," - Nh\u1eadn d\u1ea1ng pattern giao th\xf4ng"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'class AccidentDetectionAgent(BaseAgent):\n    """Detect accidents using YOLOX model"""\n    \n    def __init__(self, config: dict):\n        super().__init__(config)\n        self.model = self._load_yolox_model()\n        self.threshold = config.get("confidence_threshold", 0.7)\n    \n    async def execute(self, context: dict) -> AgentResult:\n        images = context.get("camera_images", [])\n        accidents = []\n        \n        for img in images:\n            detections = self.model.predict(img)\n            if self._is_accident(detections):\n                accidents.append({\n                    "camera_id": img["camera_id"],\n                    "confidence": detections["confidence"],\n                    "location": img["location"],\n                    "timestamp": datetime.now().isoformat()\n                })\n        \n        # Dispatch alerts if accidents detected\n        if accidents:\n            await self.dispatch_alerts(accidents)\n        \n        return AgentResult(\n            status=AgentStatus.SUCCESS,\n            data={"accidents": accidents},\n            errors=[],\n            execution_time=self.execution_time\n        )\n'})}),"\n",(0,i.jsx)(n.h3,{id:"3-transformation-agents-",children:"3. Transformation Agents \ud83d\udd04"}),"\n",(0,i.jsx)(n.p,{children:"Chuy\u1ec3n \u0111\u1ed5i d\u1eef li\u1ec7u sang c\xe1c format chu\u1ea9n:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"NGSILDTransformerAgent"})})," - Chuy\u1ec3n sang NGSI-LD"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"SOSASSNMapperAgent"})})," - Map sang SOSA/SSN ontology"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'class NGSILDTransformerAgent(BaseAgent):\n    """Transform data to NGSI-LD format"""\n    \n    async def execute(self, context: dict) -> AgentResult:\n        entities = []\n        \n        for camera in context.get("cameras", []):\n            entity = {\n                "@context": NGSI_LD_CONTEXT,\n                "id": f"urn:ngsi-ld:TrafficCamera:{camera[\'id\']}",\n                "type": "TrafficCamera",\n                "location": {\n                    "type": "GeoProperty",\n                    "value": {\n                        "type": "Point",\n                        "coordinates": [camera["lon"], camera["lat"]]\n                    }\n                },\n                "vehicleCount": {\n                    "type": "Property",\n                    "value": camera["vehicle_count"],\n                    "observedAt": datetime.now().isoformat()\n                }\n            }\n            entities.append(entity)\n        \n        return AgentResult(\n            status=AgentStatus.SUCCESS,\n            data={"entities": entities},\n            errors=[],\n            execution_time=self.execution_time\n        )\n'})}),"\n",(0,i.jsx)(n.h3,{id:"4-rdflod-agents-",children:"4. RDF/LOD Agents \ud83d\udd17"}),"\n",(0,i.jsx)(n.p,{children:"X\u1eed l\xfd Linked Open Data:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"TriplestoreLoaderAgent"})})," - Load RDF v\xe0o Fuseki"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"ContentNegotiationAgent"})})," - Serve RDF v\u1edbi nhi\u1ec1u format"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"LODLinksetEnrichmentAgent"})})," - Li\xean k\u1ebft v\u1edbi external datasets"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"-orchestrator---\u0111i\u1ec1u-ph\u1ed1i-vi\xean",children:"\ud83d\udd04 Orchestrator - \u0110i\u1ec1u ph\u1ed1i vi\xean"}),"\n",(0,i.jsx)(n.p,{children:"Orchestrator qu\u1ea3n l\xfd vi\u1ec7c th\u1ef1c thi c\xe1c agents:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'class Orchestrator:\n    """\u0110i\u1ec1u ph\u1ed1i execution c\u1ee7a agents"""\n    \n    def __init__(self, config_path: str):\n        self.config = load_config(config_path)\n        self.agents = self._load_agents()\n        self.scheduler = AsyncIOScheduler()\n    \n    async def run_pipeline(self):\n        """Execute full pipeline"""\n        context = {}\n        \n        # Phase 1: Data Collection\n        for agent in self.agents["collection"]:\n            result = await agent.execute(context)\n            context.update(result.data)\n        \n        # Phase 2: Analytics\n        analytics_tasks = [\n            agent.execute(context) \n            for agent in self.agents["analytics"]\n        ]\n        results = await asyncio.gather(*analytics_tasks)\n        \n        # Phase 3: Transformation & Publishing\n        for agent in self.agents["transformation"]:\n            result = await agent.execute(context)\n            context.update(result.data)\n        \n        return context\n'})}),"\n",(0,i.jsx)(n.h2,{id:"-performance-metrics",children:"\ud83d\udcc8 Performance Metrics"}),"\n",(0,i.jsx)(n.p,{children:"Sau 6 th\xe1ng v\u1eadn h\xe0nh:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Metric"}),(0,i.jsx)(n.th,{children:"Value"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Agents deployed"}),(0,i.jsx)(n.td,{children:"30+"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Avg execution time"}),(0,i.jsx)(n.td,{children:"2.3s"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Success rate"}),(0,i.jsx)(n.td,{children:"99.7%"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Data processed/day"}),(0,i.jsx)(n.td,{children:"50GB+"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Cameras monitored"}),(0,i.jsx)(n.td,{children:"1000+"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"-lessons-learned",children:"\ud83c\udf93 Lessons Learned"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Async is key"})," - S\u1eed d\u1ee5ng ",(0,i.jsx)(n.code,{children:"asyncio"})," cho t\u1ea5t c\u1ea3 I/O operations"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Graceful degradation"})," - Agent l\u1ed7i kh\xf4ng crash h\u1ec7 th\u1ed1ng"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Observability"})," - Log v\xe0 metric cho m\u1ecdi agent"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Config-driven"})," - Thay \u0111\u1ed5i behavior kh\xf4ng c\u1ea7n code"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"-k\u1ebft-lu\u1eadn",children:"\ud83d\ude80 K\u1ebft lu\u1eadn"}),"\n",(0,i.jsx)(n.p,{children:"Agent System gi\xfap UIP:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u2705 X\u1eed l\xfd ",(0,i.jsx)(n.strong,{children:"1000+ cameras"})," real-time"]}),"\n",(0,i.jsxs)(n.li,{children:["\u2705 Ph\xe1t hi\u1ec7n tai n\u1ea1n trong ",(0,i.jsx)(n.strong,{children:"< 3 gi\xe2y"})]}),"\n",(0,i.jsx)(n.li,{children:"\u2705 Scale horizontally d\u1ec5 d\xe0ng"}),"\n",(0,i.jsx)(n.li,{children:"\u2705 Maintain v\xe0 extend \u0111\u01a1n gi\u1ea3n"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"B\u1ea1n c\xf3 c\xe2u h\u1ecfi v\u1ec1 Agent System?"})," Comment b\xean d\u01b0\u1edbi ho\u1eb7c m\u1edf issue tr\xean ",(0,i.jsx)(n.a,{href:"https://github.com/NguyenNhatquang522004/UIP-Urban_Intelligence_Platform",children:"GitHub"}),"!"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.em,{children:"Nguy\u1ec5n Nh\u1eadt Quang - Lead Developer @ UIP Team"})})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},7821:e=>{e.exports=JSON.parse('{"permalink":"/tes/blog/agent-system-deep-dive","editUrl":"https://github.com/NguyenNhatquang522004/UIP-Urban_Intelligence_Platform/tree/main/apps/traffic-web-app/frontend/docs/blog/2024-02-20-agent-system-deep-dive.md","source":"@site/blog/2024-02-20-agent-system-deep-dive.md","title":"\ud83e\udd16 Deep Dive v\xe0o Agent System c\u1ee7a UIP","description":"\x3c!--","date":"2024-02-20T00:00:00.000Z","tags":[{"inline":false,"label":"UIP","permalink":"/tes/blog/tags/uip","description":"UIP - Urban Intelligence Platform core content"},{"inline":false,"label":"Architecture","permalink":"/tes/blog/tags/architecture","description":"System architecture and design patterns"},{"inline":false,"label":"Agents","permalink":"/tes/blog/tags/agents","description":"Multi-agent system and orchestration"},{"inline":false,"label":"Python","permalink":"/tes/blog/tags/python","description":"Python programming and best practices"},{"inline":false,"label":"Technical","permalink":"/tes/blog/tags/technical","description":"Technical deep dives and explanations"}],"readingTime":3.83,"hasTruncateMarker":true,"authors":[{"name":"Nguy\u1ec5n Nh\u1eadt Quang","title":"Lead Developer & System Architect","url":"https://github.com/NguyenNhatquang522004","page":{"permalink":"/tes/blog/authors/nguyennhatquang"},"socials":{"github":"https://github.com/NguyenNhatquang522004","email":"mailto:nguyennhatquang522004@gmail.com"},"imageURL":"https://github.com/NguyenNhatquang522004.png","key":"nguyennhatquang"}],"frontMatter":{"slug":"agent-system-deep-dive","title":"\ud83e\udd16 Deep Dive v\xe0o Agent System c\u1ee7a UIP","authors":["nguyennhatquang"],"tags":["uip","architecture","agents","python","technical"]},"unlisted":false,"prevItem":{"title":"\ud83d\udd17 T\xedch h\u1ee3p Linked Open Data trong UIP","permalink":"/tes/blog/linked-open-data-integration"},"nextItem":{"title":"\ud83d\ude80 Gi\u1edbi thi\u1ec7u UIP - Urban Intelligence Platform","permalink":"/tes/blog/introducing-uip"}}')},8453:(e,n,t)=>{t.d(n,{R:()=>c,x:()=>r});var s=t(6540);const i={},a=s.createContext(i);function c(e){const n=s.useContext(a);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);